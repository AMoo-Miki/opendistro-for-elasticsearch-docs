<!DOCTYPE html>

<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  

  <title>Apply Configuration Changes - Open Distro for Elasticsearch Documentation</title>
  <link rel="stylesheet" href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/css/just-the-docs.css">
  <link rel="shortcut icon" href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/images/favicon.ico">

  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135423944-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-135423944-1');
    </script>
  

  
    <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/js/search-data.js"></script>
    <script src="https://unpkg.com/lunr/lunr.js"></script>
  

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
  

  <!-- SiteCatalyst code version: H.25.1. Copyright 1996-2012 Adobe, Inc. All Rights Reserved -->
  <script><!--
  /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
  var s_code=s.t();if(s_code)document.write(s_code)//--></script>
  <script language="JavaScript" type="text/javascript"><!--
  if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
  //--></script>
  <noscript>
  <img src="//amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazonalldev2/1/H.25.1--NS/0" height="1" width="1" border="0" alt="" />
  </noscript>
  <!--/DO NOT REMOVE/-->
  <!-- End SiteCatalyst code version: H.25.1. -->

  <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/" class="site-title"><img src="/for-elasticsearch-docs/old/0.9.0/assets/images/logo.svg"></a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list">
    
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/" class="navigation-list-link">About</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/" class="navigation-list-link">Install and Configure</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/docker/" class="navigation-list-link">Docker</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/rpm/" class="navigation-list-link">RPM</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/deb/" class="navigation-list-link">Debian Package</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/docker-security/" class="navigation-list-link">Docker Security Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/plugins/" class="navigation-list-link">Standalone Elasticsearch Plugin Install</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/other-components/" class="navigation-list-link">Other Components</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/encryption-at-rest/" class="navigation-list-link">Encryption at Rest</a>
                      
                    </li>
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/" class="navigation-list-link">Elasticsearch</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/configuration/" class="navigation-list-link">Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/index-data/" class="navigation-list-link">Index Data</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/full-text/" class="navigation-list-link">Full-Text Queries</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/snapshot-restore/" class="navigation-list-link">Take and Restore Snapshots</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/" class="navigation-list-link">Kibana</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/plugins/" class="navigation-list-link">Standalone Kibana Plugin Install</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/maptiles/" class="navigation-list-link">WMS Map Server</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item active">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/" class="navigation-list-link">Security</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/concepts/" class="navigation-list-link">Basics</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/configuration/" class="navigation-list-link">Backend Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item  active">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/security-admin/" class="navigation-list-link active">Apply Configuration Changes</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/tls-configuration/" class="navigation-list-link">TLS Certificates</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/generate-certificates/" class="navigation-list-link">Generate Certificates</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/ldap/" class="navigation-list-link">Active Directory and LDAP</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/saml/" class="navigation-list-link">SAML</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/openid-connect/" class="navigation-list-link">OpenID Connect</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/default-action-groups/" class="navigation-list-link">Default Action Groups</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/permissions/" class="navigation-list-link">Permissions</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/document-level-security/" class="navigation-list-link">Document-Level Security</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/cross-cluster-search/" class="navigation-list-link">Cross-Cluster Search</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-logs/" class="navigation-list-link">Audit Logs</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-log-storage-types/" class="navigation-list-link">Audit Log Storage Types</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-logs-field-reference/" class="navigation-list-link">Audit Log Field Reference</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/disable/" class="navigation-list-link">Disable Security</a>
                      
                    </li>
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/" class="navigation-list-link">Alerting</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/monitors/" class="navigation-list-link">Monitors</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/settings/" class="navigation-list-link">Management</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/security-roles/" class="navigation-list-link">Security Roles</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/cron/" class="navigation-list-link">Cron</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/" class="navigation-list-link">SQL</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/operations/" class="navigation-list-link">Supported Operations</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/jdbc/" class="navigation-list-link">JDBC Driver</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/joins/" class="navigation-list-link">Joins</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/" class="navigation-list-link">Performance Analyzer</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/dashboards/" class="navigation-list-link">Create Dashboards</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/reference/" class="navigation-list-link">Metrics Reference</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/troubleshoot/" class="navigation-list-link">Troubleshoot</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
  </ul>
</nav>

      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-100">See a problem? Submit <a href="https://github.com/opendistro/for-elasticsearch-docs/issues">issues</a> or <a href="https://github.com/opendistro/for-elasticsearch-docs/pulls">pull requests</a> on <a href="https://github.com/opendistro/for-elasticsearch-docs">GitHub</a>.</p>
        <p class="text-small text-grey-dk-100 mb-0">© 2020 Amazon Web Services, Inc. or its affiliates. All rights reserved.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          <div class="search js-search">
            <div class="search-input-wrap">
              <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search..." aria-label="Search" autocomplete="off">
              <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg>
            </div>
            <div class="js-search-results search-results-wrap"></div>
          </div>
          
          
            <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
              
                <li class="d-inline-block my-0"><a href="https://opendistro.github.io/for-elasticsearch/">Back to the Open Distro for Elasticsearch home page</a></li>
              
            </ul>
          
        </div>
      </div>
      <div class="main-content">
        
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                  <li class="breadcrumb-nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/">Security</a></li>
                
                <li class="breadcrumb-nav-list-item"><span>Apply Configuration Changes</span></li>
              </ol>
            </nav>
          
        
        <div id="main-content" class="page-content" role="main">
          <h1 id="apply-configuration-changes">Apply configuration changes</h1>

<p>The Security plugin stores its configuration—including users, roles, and permissions—in an index on the Elasticsearch cluster (<code class="highlighter-rouge">.opendistro_security</code>). Storing these settings in an index lets you change settings without restarting the cluster and eliminates the need to place configuration files on any node.</p>

<p>After changing any of the configuration files in <code class="highlighter-rouge">plugins/opendistro_security/securityconfig</code>, however, you must run <code class="highlighter-rouge">plugins/opendistro_security/tools/securityadmin.sh</code> to load these new settings into the index. This script identifies itself against a cluster through an admin TLS certificate, in <code class="highlighter-rouge">.pem</code>, <code class="highlighter-rouge">.jks</code>, <code class="highlighter-rouge">.p12</code>, or <code class="highlighter-rouge">.pfx</code> format.</p>

<p>If the <code class="highlighter-rouge">.opendistro_security</code> index is already initialized, you can also use Kibana to change users, roles, and permissions. However, you need to run <code class="highlighter-rouge">securityadmin.sh</code> at least once to initialize the index and configure your authentication and authorization methods.</p>

<hr />

<h4 id="table-of-contents">Table of contents</h4>
<ol id="markdown-toc">
  <li><a href="#configure-the-admin-certificate" id="markdown-toc-configure-the-admin-certificate">Configure the admin certificate</a></li>
  <li><a href="#basic-usage" id="markdown-toc-basic-usage">Basic usage</a></li>
  <li><a href="#sample-commands" id="markdown-toc-sample-commands">Sample commands</a></li>
  <li><a href="#using-securityadmin-with-keystore-and-truststore-files" id="markdown-toc-using-securityadmin-with-keystore-and-truststore-files">Using securityadmin with Keystore and Truststore files</a>    <ol>
      <li><a href="#elasticsearch-settings" id="markdown-toc-elasticsearch-settings">Elasticsearch settings</a></li>
      <li><a href="#certificate-validation-settings" id="markdown-toc-certificate-validation-settings">Certificate validation settings</a></li>
      <li><a href="#configuration-files-settings" id="markdown-toc-configuration-files-settings">Configuration files settings</a></li>
      <li><a href="#cipher-settings" id="markdown-toc-cipher-settings">Cipher settings</a></li>
      <li><a href="#backup-and-restore" id="markdown-toc-backup-and-restore">Backup and Restore</a></li>
      <li><a href="#other-options" id="markdown-toc-other-options">Other options</a></li>
    </ol>
  </li>
</ol>

<hr />

<h2 id="configure-the-admin-certificate">Configure the admin certificate</h2>

<p>You can configure all certificates that should have admin privileges in <code class="highlighter-rouge">elasticsearch.yml</code> stating their respective Distinguished Names (DNs). If you use the demo certificates, for example, you can use the <code class="highlighter-rouge">kirk</code> certificate:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">opendistro_security.authcz.admin_dn</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">CN=kirk,OU=client,O=client,L=test,C=DE</span>
</code></pre></div></div>

<p class="warning">Do not use node certificates as admin certificates. Best practice is to keep these certificates separate. Also, do not use any whitespace between the parts of the DN.</p>

<h2 id="basic-usage">Basic usage</h2>

<p><code class="highlighter-rouge">securityadmin.sh</code> can be run from any machine that has access to the transport port of your Elasticsearch cluster (default is 9300); you can change the Security plugin configuration without having to access your nodes via SSH.</p>

<p>Each node also includes the tool at <code class="highlighter-rouge">plugins/opendistro_security/tools/securityadmin.sh</code>. You might need to make the script executable before running it:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x plugins/opendistro_security/tools/securityadmin.sh
</code></pre></div></div>

<p>To print all available command line options, run the script with no arguments:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./plugins/opendistro_security/tools/securityadmin.sh
</code></pre></div></div>

<p>To load configuration changes to Security plugin, you need to provide your admin certificate to the tool:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="nt">-cd</span> ../securityconfig/ <span class="nt">-icl</span> <span class="nt">-nhnv</span>  
   <span class="nt">-cacert</span> ../../../config/root-ca.pem
   <span class="nt">-cert</span> ../../../config/kirk.pem
   <span class="nt">-key</span> ../../../config/kirk-key.pem
</code></pre></div></div>

<ul>
  <li>The <code class="highlighter-rouge">-cd</code> option speficies where the Security plugin configuration files to upload to the cluster can be found.</li>
  <li>The <code class="highlighter-rouge">-icl</code> (<code class="highlighter-rouge">--ignore-clustername</code>) option tells the Security plugin to upload the configuration regardless of the cluster name. As an alternative, you can also specify the cluster name with the <code class="highlighter-rouge">-cn</code> (<code class="highlighter-rouge">--clustername</code>) option.</li>
  <li>Because the demo certificates are self-signed, we also disable hostname verification with the <code class="highlighter-rouge">-nhnv</code> (<code class="highlighter-rouge">--disable-host-name-verification</code>) option.</li>
  <li>The <code class="highlighter-rouge">-cacert</code>, <code class="highlighter-rouge">-cert</code> and <code class="highlighter-rouge">-key</code> options define the location of your root CA certificate, the admin certificate, and the private key for the admin certificate. If the private key has a password, specify it with the <code class="highlighter-rouge">-keypass</code> option.</li>
</ul>

<p>All PEM options:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-cert</td>
      <td>The location of the PEM file containing the admin certificate and all intermediate certificates, if any. You can use an absolute or relative path. Relative paths are resolved relative to the execution directory of .</td>
    </tr>
    <tr>
      <td>-key</td>
      <td>The location of the PEM file containing the private key of the admin certificate. You can use an absolute or relative path. Relative paths are resolved relative to the execution directory of <code class="highlighter-rouge">securityadmin.sh</code>. The key must be in PKCS#8 format.</td>
    </tr>
    <tr>
      <td>-keypass</td>
      <td>The password of the private key of the admin certificate, if any.</td>
    </tr>
    <tr>
      <td>-cacert</td>
      <td>The location of the PEM file containing the root certificate. You can use an absolute or relative path. Relative paths are resolved relative to the execution directory of <code class="highlighter-rouge">securityadmin.sh</code>.</td>
    </tr>
  </tbody>
</table>

<h2 id="sample-commands">Sample commands</h2>

<p>Apply configuration in <code class="highlighter-rouge">securityconfig</code> using PEM certificates:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/share/elasticsearch/plugins/opendistro_security/tools/securityadmin.sh <span class="nt">-cacert</span> /etc/elasticsearch/root-ca.pem <span class="nt">-cert</span> /etc/elasticsearch/kirk.pem <span class="nt">-key</span> /etc/elasticsearch/kirk-key.pem <span class="nt">-cd</span> /usr/share/elasticsearch/plugins/opendistro_security/securityconfig/
</code></pre></div></div>

<p>Apply configuration from a single file (<code class="highlighter-rouge">config.yml</code>) using PEM certificates:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="nt">-f</span> ../securityconfig/config.yml <span class="nt">-icl</span> <span class="nt">-nhnv</span> <span class="nt">-cert</span> /etc/elasticsearch/kirk.pem <span class="nt">-cacert</span> /etc/elasticsearch/root-ca.pem <span class="nt">-h</span> <span class="nt">-key</span> /etc/elasticsearch/kirk-key.pem <span class="nt">-t</span> config
</code></pre></div></div>

<p>Apply configuration in <code class="highlighter-rouge">securityconfig</code> with keystore and truststore files:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="se">\</span>
   <span class="nt">-cd</span> /usr/share/elasticsearch/plugins/opendistro_security/securityconfig/ <span class="se">\</span>
   <span class="nt">-ks</span> /path/to/keystore.jks <span class="se">\</span>
   <span class="nt">-kspass</span> changeit <span class="se">\</span>
   <span class="nt">-ts</span> /path/to/truststore.jks <span class="se">\</span>
   <span class="nt">-tspass</span> changeit
   <span class="nt">-nhnv</span>
   <span class="nt">-icl</span>
</code></pre></div></div>

<h2 id="using-securityadmin-with-keystore-and-truststore-files">Using securityadmin with Keystore and Truststore files</h2>

<p>You can also use keystore files in JKS format in conjunction with <code class="highlighter-rouge">securityadmin.sh</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="nt">-cd</span> ../securityconfig <span class="nt">-icl</span> <span class="nt">-nhnv</span>
  <span class="nt">-ts</span> &lt;path/to/truststore&gt; <span class="nt">-tspass</span> &lt;truststore password&gt;
  <span class="nt">-ks</span> &lt;path/to/keystore&gt; <span class="nt">-kspass</span> &lt;keystore password&gt;
</code></pre></div></div>

<p>Use the following options to control the key and truststore settings:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-ks</td>
      <td>The location of the keystore containing the admin certificate and all intermediate certificates, if any. You can use an absolute or relative path. Relative paths are resolved relative to the execution directory of <code class="highlighter-rouge">securityadmin.sh</code>.</td>
    </tr>
    <tr>
      <td>-kspass</td>
      <td>The password for the keystore.</td>
    </tr>
    <tr>
      <td>-kst</td>
      <td>The key store type, either JKS or PKCS#12/PFX. If not specified, the Security plugin tries to determine the type from the file extension.</td>
    </tr>
    <tr>
      <td>-ksalias</td>
      <td>The alias of the admin certificate, if any.</td>
    </tr>
    <tr>
      <td>-ts</td>
      <td>The location of the truststore containing the root certificate. You can use an absolute or relative path. Relative paths are resolved relative to the execution directory of <code class="highlighter-rouge">securityadmin.sh</code>.</td>
    </tr>
    <tr>
      <td>-tspass</td>
      <td>The password for the truststore.</td>
    </tr>
    <tr>
      <td>-tst</td>
      <td>The truststore type, either JKS or PKCS#12/PFX. If not specified, the Security plugin tries to determine the type from the file extension.</td>
    </tr>
    <tr>
      <td>-tsalias</td>
      <td>The alias for the root certificate, if any.</td>
    </tr>
  </tbody>
</table>

<h3 id="elasticsearch-settings">Elasticsearch settings</h3>

<p>If you run a default Elasticsearch installation, which listens on transport port 9300, and uses <code class="highlighter-rouge">elasticsearch</code> as cluster name, you can omit the following settings altogether. Otherwise, specify your Elasticsearch settings by using the following switches:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-h</td>
      <td>Elasticsearch hostname. Default is <code class="highlighter-rouge">localhost</code>.</td>
    </tr>
    <tr>
      <td>-p</td>
      <td>Elasticsearch port. Default is 9300—not the HTTP port.</td>
    </tr>
    <tr>
      <td>-cn</td>
      <td>Cluster name. Default is <code class="highlighter-rouge">elasticsearch</code>.</td>
    </tr>
    <tr>
      <td>-icl</td>
      <td>Ignore cluster name.</td>
    </tr>
    <tr>
      <td>-sniff</td>
      <td>Sniff cluster nodes. Sniffing detects available nodes using the Elasticsearch <code class="highlighter-rouge">_cluster/state</code> API.</td>
    </tr>
    <tr>
      <td>-arc,–accept-red-cluster</td>
      <td>Execute <code class="highlighter-rouge">securityadmin.sh</code> even if the cluster state is red. Default is false, which means the script will not execute on a red cluster.</td>
    </tr>
  </tbody>
</table>

<h3 id="certificate-validation-settings">Certificate validation settings</h3>

<p>Use the following options to control certificate validation:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-nhnv</td>
      <td>Do not validate hostname. Default is false.</td>
    </tr>
    <tr>
      <td>-nrhn</td>
      <td>Do not resolve hostname. Only relevant if <code class="highlighter-rouge">-nhnv</code> is not set.</td>
    </tr>
    <tr>
      <td>-noopenssl</td>
      <td>Do not use OpenSSL, even if available. Default is to use OpenSSL if it is available.</td>
    </tr>
  </tbody>
</table>

<h3 id="configuration-files-settings">Configuration files settings</h3>

<p>The following switches define which configuration file(s) you want to push to the Security plugin. You can either push a single file or specify a directory containing one or more configuration files.</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-cd</td>
      <td>Directory containing multiple Security plugin configuration files.</td>
    </tr>
    <tr>
      <td>-f</td>
      <td>Single configuration file. Can’t be used with <code class="highlighter-rouge">-cd</code>.</td>
    </tr>
    <tr>
      <td>-t</td>
      <td>File type.</td>
    </tr>
    <tr>
      <td>-rl</td>
      <td>Reload the current configuration and flush the internal cache.</td>
    </tr>
  </tbody>
</table>

<p>To upload all configuration files in a directory, use:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="nt">-cd</span> ../securityconfig <span class="nt">-ts</span> ... <span class="nt">-tspass</span> ... <span class="nt">-ks</span> ... <span class="nt">-kspass</span> ...
</code></pre></div></div>

<p>If you want to push a single configuration file, use:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="nt">-f</span> ../securityconfig/internal_users.yml <span class="nt">-t</span> internalusers  <span class="se">\</span>
    <span class="nt">-ts</span> ... <span class="nt">-tspass</span> ... <span class="nt">-ks</span> ... <span class="nt">-kspass</span> ...
</code></pre></div></div>

<p>The file type must be one of:</p>

<ul>
  <li>config</li>
  <li>roles</li>
  <li>rolesmapping</li>
  <li>internalusers</li>
  <li>actiongroups</li>
</ul>

<h3 id="cipher-settings">Cipher settings</h3>

<p>You probably won’t need to change cipher settings. If you need to, use the following options:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-ec</td>
      <td>Ccomma-separated list of enabled TLS ciphers.</td>
    </tr>
    <tr>
      <td>-ep</td>
      <td>Comma-separated list of enabled TLS protocols.</td>
    </tr>
  </tbody>
</table>

<h3 id="backup-and-restore">Backup and Restore</h3>

<p>You can download all current configuration files from your cluster with the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="nt">-r</span> <span class="nt">-ts</span> ... <span class="nt">-tspass</span> ... <span class="nt">-ks</span> ... <span class="nt">-kspass</span> ...
</code></pre></div></div>

<p>This command dumps the current Security plugin configuration from your cluster to individual files in the working directory. You can then use these files as backups or to load the configuration into a different cluster. This command is useful when moving a proof-of-concept to production.</p>

<p>You can specify the download location with the <code class="highlighter-rouge">-cd</code> option:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="nt">-r</span> <span class="nt">-h</span> staging.example.com <span class="nt">-p</span> 9300  <span class="se">\</span>
    <span class="nt">-cd</span> /etc/backup/ <span class="nt">-ts</span> ... <span class="nt">-tspass</span> ... <span class="nt">-ks</span> ... <span class="nt">-kspass</span> ...
</code></pre></div></div>

<p>To upload the dumped files to another cluster:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./securityadmin.sh <span class="nt">-h</span> production.example.com <span class="nt">-p</span> 9301 <span class="nt">-cd</span> /etc/backup/  <span class="se">\</span>
    <span class="nt">-ts</span> ... <span class="nt">-tspass</span> ... <span class="nt">-ks</span> ... <span class="nt">-kspass</span> ...
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-r</td>
      <td>Retrieve the current Security plugin configuration from a running cluster and dump it to the working directory.</td>
    </tr>
    <tr>
      <td>-cd</td>
      <td>Specify the directory to store the files to. You can use an absolute or relative path. Relative paths are resolved relative to the execution directory of <code class="highlighter-rouge">securityadmin.sh</code>.</td>
    </tr>
  </tbody>
</table>

<h3 id="other-options">Other options</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-dci</td>
      <td>Delete the Security plugin configuration index and exit. This option is useful if the cluster state is red due to a corrupted Security plugin index.</td>
    </tr>
    <tr>
      <td>-esa</td>
      <td>Enable shard allocation and exit. This option is useful if you disabled shard allocation while performing a full cluster restart and need to recreate the Security plugin index.</td>
    </tr>
    <tr>
      <td>-si</td>
      <td>Displays the currently active Security plugin license</td>
    </tr>
    <tr>
      <td>-w</td>
      <td>Displays information about the used admin certificate</td>
    </tr>
    <tr>
      <td>-rl</td>
      <td>By default, the Security plugin caches authenticated users, along with their roles and permissions, for one hour. This option reloads the current Security plugin configuration stored in your cluster, invalidating any cached users, roles and permissions.</td>
    </tr>
    <tr>
      <td>-i</td>
      <td>The Security plugin index name. Default is <code class="highlighter-rouge">.opendistro_security</code>.</td>
    </tr>
    <tr>
      <td>-er</td>
      <td>Set explicit number of replicas or auto-expand expression for the <code class="highlighter-rouge">opendistro_security</code> index.</td>
    </tr>
    <tr>
      <td>-era</td>
      <td>Enable replica auto-expand.</td>
    </tr>
    <tr>
      <td>-dra</td>
      <td>Disable replica auto-expand.</td>
    </tr>
    <tr>
      <td>-us</td>
      <td>Update the replica settings.</td>
    </tr>
  </tbody>
</table>


          
        </div>
      </div>
    </div>
  </div>
  
    <script>
      anchors.add();
    </script>
  
</body>
</html>

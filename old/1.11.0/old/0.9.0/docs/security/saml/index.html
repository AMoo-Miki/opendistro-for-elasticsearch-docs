<!DOCTYPE html>

<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  

  <title>SAML - Open Distro for Elasticsearch Documentation</title>
  <link rel="stylesheet" href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/css/just-the-docs.css">
  <link rel="shortcut icon" href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/images/favicon.ico">

  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135423944-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-135423944-1');
    </script>
  

  
    <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/js/search-data.js"></script>
    <script src="https://unpkg.com/lunr/lunr.js"></script>
  

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
  

  <!-- SiteCatalyst code version: H.25.1. Copyright 1996-2012 Adobe, Inc. All Rights Reserved -->
  <script><!--
  /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
  var s_code=s.t();if(s_code)document.write(s_code)//--></script>
  <script language="JavaScript" type="text/javascript"><!--
  if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
  //--></script>
  <noscript>
  <img src="//amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazonalldev2/1/H.25.1--NS/0" height="1" width="1" border="0" alt="" />
  </noscript>
  <!--/DO NOT REMOVE/-->
  <!-- End SiteCatalyst code version: H.25.1. -->

  <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/" class="site-title"><img src="/for-elasticsearch-docs/old/0.9.0/assets/images/logo.svg"></a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list">
    
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/" class="navigation-list-link">About</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/" class="navigation-list-link">Install and Configure</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/docker/" class="navigation-list-link">Docker</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/rpm/" class="navigation-list-link">RPM</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/deb/" class="navigation-list-link">Debian Package</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/docker-security/" class="navigation-list-link">Docker Security Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/plugins/" class="navigation-list-link">Standalone Elasticsearch Plugin Install</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/other-components/" class="navigation-list-link">Other Components</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/encryption-at-rest/" class="navigation-list-link">Encryption at Rest</a>
                      
                    </li>
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/" class="navigation-list-link">Elasticsearch</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/configuration/" class="navigation-list-link">Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/index-data/" class="navigation-list-link">Index Data</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/full-text/" class="navigation-list-link">Full-Text Queries</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/snapshot-restore/" class="navigation-list-link">Take and Restore Snapshots</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/" class="navigation-list-link">Kibana</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/plugins/" class="navigation-list-link">Standalone Kibana Plugin Install</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/maptiles/" class="navigation-list-link">WMS Map Server</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item active">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/" class="navigation-list-link">Security</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/concepts/" class="navigation-list-link">Basics</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/configuration/" class="navigation-list-link">Backend Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/security-admin/" class="navigation-list-link">Apply Configuration Changes</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/tls-configuration/" class="navigation-list-link">TLS Certificates</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/generate-certificates/" class="navigation-list-link">Generate Certificates</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/ldap/" class="navigation-list-link">Active Directory and LDAP</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item  active">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/saml/" class="navigation-list-link active">SAML</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/openid-connect/" class="navigation-list-link">OpenID Connect</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/default-action-groups/" class="navigation-list-link">Default Action Groups</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/permissions/" class="navigation-list-link">Permissions</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/document-level-security/" class="navigation-list-link">Document-Level Security</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/cross-cluster-search/" class="navigation-list-link">Cross-Cluster Search</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-logs/" class="navigation-list-link">Audit Logs</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-log-storage-types/" class="navigation-list-link">Audit Log Storage Types</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-logs-field-reference/" class="navigation-list-link">Audit Log Field Reference</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/disable/" class="navigation-list-link">Disable Security</a>
                      
                    </li>
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/" class="navigation-list-link">Alerting</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/monitors/" class="navigation-list-link">Monitors</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/settings/" class="navigation-list-link">Management</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/security-roles/" class="navigation-list-link">Security Roles</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/cron/" class="navigation-list-link">Cron</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/" class="navigation-list-link">SQL</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/operations/" class="navigation-list-link">Supported Operations</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/jdbc/" class="navigation-list-link">JDBC Driver</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/joins/" class="navigation-list-link">Joins</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/" class="navigation-list-link">Performance Analyzer</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/dashboards/" class="navigation-list-link">Create Dashboards</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/reference/" class="navigation-list-link">Metrics Reference</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/troubleshoot/" class="navigation-list-link">Troubleshoot</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
  </ul>
</nav>

      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-100">See a problem? Submit <a href="https://github.com/opendistro/for-elasticsearch-docs/issues">issues</a> or <a href="https://github.com/opendistro/for-elasticsearch-docs/pulls">pull requests</a> on <a href="https://github.com/opendistro/for-elasticsearch-docs">GitHub</a>.</p>
        <p class="text-small text-grey-dk-100 mb-0">© 2020 Amazon Web Services, Inc. or its affiliates. All rights reserved.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          <div class="search js-search">
            <div class="search-input-wrap">
              <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search..." aria-label="Search" autocomplete="off">
              <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg>
            </div>
            <div class="js-search-results search-results-wrap"></div>
          </div>
          
          
            <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
              
                <li class="d-inline-block my-0"><a href="https://opendistro.github.io/for-elasticsearch/">Back to the Open Distro for Elasticsearch home page</a></li>
              
            </ul>
          
        </div>
      </div>
      <div class="main-content">
        
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                  <li class="breadcrumb-nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/">Security</a></li>
                
                <li class="breadcrumb-nav-list-item"><span>SAML</span></li>
              </ol>
            </nav>
          
        
        <div id="main-content" class="page-content" role="main">
          <h1 id="saml">SAML</h1>

<p>The Security plugin supports user authentication via SAML single sign-on. The Security plugin implements the web browser SSO profile of the SAML 2.0 protocol.</p>

<p>This profile is meant for use with web browsers. It is not a general-purpose way of authenticating users against the Security plugin, so its primary use case is to support Kibana single sign-on.</p>

<hr />

<h4 id="table-of-contents">Table of contents</h4>
<ol id="markdown-toc">
  <li><a href="#activating-saml" id="markdown-toc-activating-saml">Activating SAML</a></li>
  <li><a href="#running-multiple-authentication-domains" id="markdown-toc-running-multiple-authentication-domains">Running multiple authentication domains</a></li>
  <li><a href="#identity-provider-metadata" id="markdown-toc-identity-provider-metadata">Identity provider metadata</a></li>
  <li><a href="#idp-and-service-provider-entity-id" id="markdown-toc-idp-and-service-provider-entity-id">Idp and service provider entity ID</a></li>
  <li><a href="#kibana-settings" id="markdown-toc-kibana-settings">Kibana settings</a></li>
  <li><a href="#username-and-role-attributes" id="markdown-toc-username-and-role-attributes">Username and Role attributes</a></li>
  <li><a href="#request-signing" id="markdown-toc-request-signing">Request signing</a></li>
  <li><a href="#logout" id="markdown-toc-logout">Logout</a></li>
  <li><a href="#exchange-key-settings" id="markdown-toc-exchange-key-settings">Exchange key settings</a></li>
  <li><a href="#tls-settings" id="markdown-toc-tls-settings">TLS settings</a>    <ol>
      <li><a href="#certificate-validation" id="markdown-toc-certificate-validation">Certificate validation</a></li>
      <li><a href="#client-authentication" id="markdown-toc-client-authentication">Client authentication</a></li>
      <li><a href="#enabled-ciphers-and-protocols" id="markdown-toc-enabled-ciphers-and-protocols">Enabled ciphers and protocols</a></li>
    </ol>
  </li>
  <li><a href="#minimal-configuration-example" id="markdown-toc-minimal-configuration-example">Minimal configuration example</a></li>
  <li><a href="#kibana-configuration" id="markdown-toc-kibana-configuration">Kibana configuration</a></li>
</ol>

<hr />

<h2 id="activating-saml">Activating SAML</h2>

<p>To use SAML for authentication, you need to configure a respective authentication domain in the <code class="highlighter-rouge">authc</code> section of <code class="highlighter-rouge">plugins/opendistro_security/securityconfig/config.yml</code>. Since SAML works solely on the HTTP layer, you do not need any <code class="highlighter-rouge">authentication_backend</code> and can set it to <code class="highlighter-rouge">noop</code>. Place all SAML specific configuration options in this chapter in the <code class="highlighter-rouge">config</code> section of the SAML HTTP authenticator:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">authc</span><span class="pi">:</span>
  <span class="na">saml_auth_domain</span><span class="pi">:</span>
    <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">saml</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">idp</span><span class="pi">:</span>
          <span class="na">metadata_file</span><span class="pi">:</span> <span class="s">okta.xml</span>
          <span class="s">...</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div>

<p>Once you have configured SAML in <code class="highlighter-rouge">config.yml</code>, you need to also <a href="#kibana-configuration">activate it in Kibana</a>.</p>

<h2 id="running-multiple-authentication-domains">Running multiple authentication domains</h2>

<p>We recommend adding at least one other authentication domain, such as LDAP or the internal user database, to support API access to Elasticsearch without SAML. For Kibana and the internal Kibana server user, you also need to add another authentication domain that supports basic authentication. This authentication domain should be placed first in the chain, and the <code class="highlighter-rouge">challenge</code> flag must be set to <code class="highlighter-rouge">false</code>:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">authc</span><span class="pi">:</span>
  <span class="na">basic_internal_auth_domain</span><span class="pi">:</span>
    <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">0</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">basic</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">false</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">internal</span>
  <span class="na">saml_auth_domain</span><span class="pi">:</span>
     <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
     <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
     <span class="na">http_authenticator</span><span class="pi">:</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s1">'</span><span class="s">saml'</span>
        <span class="na">challenge</span><span class="pi">:</span> <span class="no">true</span>
        <span class="na">config</span><span class="pi">:</span>
            <span class="s">...</span>
     <span class="na">authentication_backend</span><span class="pi">:</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div>

<h2 id="identity-provider-metadata">Identity provider metadata</h2>

<p>A SAML identity provider (IdP) provides a SAML 2.0 metadata file describing the IdP’ss capabilities and configuration. The Security plugin can read IdP metadata either from a URL or a file. Which way to choose depends on your IdP and your preferences. The SAML 2.0 metadata file is required.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">idp.metadata_file</td>
      <td style="text-align: left">The path to the SAML 2.0 metadata file of your IdP. Place the metadata file in the <code class="highlighter-rouge">config</code> directory of Open Distro for Elasticsearch. The path has to be specified relative to the <code class="highlighter-rouge">config</code> directory. Required if <code class="highlighter-rouge">idp.metadata_url</code> is not set.</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.metadata_url</td>
      <td style="text-align: left">The SAML 2.0 metadata URL of your IdP. Required if <code class="highlighter-rouge">idp.metadata_file</code> is not set.</td>
    </tr>
  </tbody>
</table>

<h2 id="idp-and-service-provider-entity-id">Idp and service provider entity ID</h2>

<p>An entity ID is a globally unique name for a SAML entity, either an IdP or a service provider (SP). The IdP entity ID is usually provided by your IdP. The SP entity ID is the name of the configured application or client in your IdP. We recommend adding a new application for Kibana and using the URL of your Kibana installation as SP entity ID.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">idp.entity_id</td>
      <td style="text-align: left">The entity ID of your IdP. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">sp.entity_id</td>
      <td style="text-align: left">The entity ID of the service provider. Required.</td>
    </tr>
  </tbody>
</table>

<h2 id="kibana-settings">Kibana settings</h2>

<p>The Web Browser SSO profile works by exchanging information via HTTP GET or POST. For example, after you log in to your IdP, it sends an HTTP POST back to Kibana containing the SAML response. You must configure the base URL of your Kibana installation where the HTTP requests are being sent to.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">kibana_url</td>
      <td style="text-align: left">The Kibana base URL. Required.</td>
    </tr>
  </tbody>
</table>

<h2 id="username-and-role-attributes">Username and Role attributes</h2>

<p>Subjects (i.e. usernames) are usually stored in the <code class="highlighter-rouge">NameID</code> element of a SAML response:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;saml2:Subject&gt;
  &lt;saml2:NameID&gt;admin&lt;/saml2:NameID&gt;
  ...
&lt;/saml2:Subject&gt;
</code></pre></div></div>

<p>If your IdP is compliant with the SAML 2.0 specification, you do not need to set anything special. If your IdP uses a different element name, you can also specify its name explicitly.</p>

<p>Role attributes are optional. However, most IdPs can be configured to add roles in the SAML assertions as well. If present, you can use these roles in your <a href="../concepts">role mappings</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;saml2:Attribute Name='Role'&gt;
  &lt;saml2:AttributeValue &gt;Everyone&lt;/saml2:AttributeValue&gt;
  &lt;saml2:AttributeValue &gt;Admins&lt;/saml2:AttributeValue&gt;
&lt;/saml2:Attribute&gt;
</code></pre></div></div>

<p>If you want to extract roles from the SAML response, you need to specify the element name that contains the roles.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">subject_key</td>
      <td style="text-align: left">The attribute in the SAML response where the subject is stored. Optional. If not configured, the <code class="highlighter-rouge">NameID</code> attribute is used.</td>
    </tr>
    <tr>
      <td style="text-align: left">roles_key</td>
      <td style="text-align: left">The attribute in the SAML response where the roles are stored. Optional. If not configured, no roles are used.</td>
    </tr>
  </tbody>
</table>

<h2 id="request-signing">Request signing</h2>

<p>Requests from the Security plugin to the IdP can optionally be signed. Use the following settings to configure request signing.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">sp.signature_private_key</td>
      <td style="text-align: left">The private key used to sign the requests. Optional. If not provided, requests are not signed.</td>
    </tr>
    <tr>
      <td style="text-align: left">sp.signature_algorithm</td>
      <td style="text-align: left">The algorithm used to sign the requests. See below for possible values.</td>
    </tr>
  </tbody>
</table>

<p>The Security plugin supports the following signature algorithms:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Algorithm</th>
      <th style="text-align: left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">DSA_SHA1</td>
      <td style="text-align: left">http://www.w3.org/2000/09/xmldsig#dsa-sha1;</td>
    </tr>
    <tr>
      <td style="text-align: left">RSA_SHA1</td>
      <td style="text-align: left">http://www.w3.org/2000/09/xmldsig#rsa-sha1;</td>
    </tr>
    <tr>
      <td style="text-align: left">RSA_SHA256</td>
      <td style="text-align: left">http://www.w3.org/2001/04/xmldsig-more#rsa-sha256;</td>
    </tr>
    <tr>
      <td style="text-align: left">RSA_SHA384</td>
      <td style="text-align: left">http://www.w3.org/2001/04/xmldsig-more#rsa-sha384;</td>
    </tr>
    <tr>
      <td style="text-align: left">RSA_SHA512</td>
      <td style="text-align: left">http://www.w3.org/2001/04/xmldsig-more#rsa-sha512;</td>
    </tr>
  </tbody>
</table>

<h2 id="logout">Logout</h2>

<p>Usually, IdPs provide information about their individual logout URL in their SAML 2.0 metadata. If this is the case, the Security plugin uses them to render the correct logout link in Kibana. If your IdP does not support an explicit logout, you can force a re-login when the user visits Kibana again.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">sp.forceAuthn</td>
      <td style="text-align: left">Force a re-login even if the user has an active session with the IdP.</td>
    </tr>
  </tbody>
</table>

<p>At the moment the Security plugin only supports the <code class="highlighter-rouge">HTTP-Redirect</code> logout binding. Please make sure this is configured correctly in your IdP.</p>

<h2 id="exchange-key-settings">Exchange key settings</h2>

<p>SAML, unlike other protocols, is not meant to be used for exchanging user credentials with each request. The Security plugin trades the SAML response for a lightweight JSON web token that stores the validated user attributes. This token is signed by an exchange key that you can choose freely. Note that when you change this key, all tokens signed with it will become invalid immediately.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">exchange_key</td>
      <td style="text-align: left">The key to sign the token. The algorithm is HMAC256, so it should have at least 32 characters.</td>
    </tr>
  </tbody>
</table>

<h2 id="tls-settings">TLS settings</h2>

<p>If you are loading the IdP metadata from a URL, we recommend to use SSL/TLS. If you use an external IdP like Okta or Auth0 that uses a trusted certificate, you usually do not need to configure anything. If you host the IdP yourself and use your own root CA, you can customize the TLS settings as follows. These settings are only used for loading SAML metadata over HTTPS.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">idp.enable_ssl</td>
      <td style="text-align: left">Whether to enable the custom TLS configuration. Default is false (JDK settings are used).</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.verify_hostnames</td>
      <td style="text-align: left">Whether to verify the hostnames of the server’s TLS certificate.</td>
    </tr>
  </tbody>
</table>

<p>Example:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">authc</span><span class="pi">:</span>
  <span class="na">saml_auth_domain</span><span class="pi">:</span>
    <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">saml</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">idp</span><span class="pi">:</span>
          <span class="na">enable_ssl</span><span class="pi">:</span> <span class="no">true</span>
          <span class="na">verify_hostnames</span><span class="pi">:</span> <span class="no">true</span>
          <span class="s">...</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div>

<h3 id="certificate-validation">Certificate validation</h3>

<p>Configure the root CA used for validating the IdP TLS certificate by setting <strong>one of</strong> the following configuration options:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">idp</span><span class="pi">:</span>
    <span class="na">pemtrustedcas_filepath</span><span class="pi">:</span> <span class="s">path/to/trusted_cas.pem</span>
</code></pre></div></div>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">idp</span><span class="pi">:</span>
    <span class="na">pemtrustedcas_content</span><span class="pi">:</span> <span class="pi">|-</span>
      <span class="s">MIID/jCCAuagAwIBAgIBATANBgkqhkiG9w0BAQUFADCBjzETMBEGCgmSJomT8ixk</span>
      <span class="s">ARkWA2NvbTEXMBUGCgmSJomT8ixkARkWB2V4YW1wbGUxGTAXBgNVBAoMEEV4YW1w</span>
      <span class="s">bGUgQ29tIEluYy4xITAfBgNVBAsMGEV4YW1wbGUgQ29tIEluYy4gUm9vdCBDQTEh</span>
      <span class="s">...</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">idp.pemtrustedcas_filepath</td>
      <td style="text-align: left">Path to the PEM file containing the root CA(s) of your IdP. The files must be placed under the Open Distro for Elasticsearch <code class="highlighter-rouge">config</code> directory, and you must specify the path relative to that same directory.</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.pemtrustedcas_content</td>
      <td style="text-align: left">The root CA content of your IdP server. Cannot be used when <code class="highlighter-rouge">pemtrustedcas_filepath</code> is set.</td>
    </tr>
  </tbody>
</table>

<h3 id="client-authentication">Client authentication</h3>

<p>The Security plugin can use TLS client authentication when fetching the IdP metadata. If enabled, the Security plugin sends a TLS client certificate to the IdP for each metadata request. Use the following keys to configure client authentication:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">idp.enable_ssl_client_auth</td>
      <td style="text-align: left">Whether to send a client certificate to the IdP server. Default is false.</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.pemcert_filepath</td>
      <td style="text-align: left">Path to the PEM file containing the client certificate. The file must be placed under the Open Distro for Elasticsearch <code class="highlighter-rouge">config</code> directory, and the path must be specified relative to the <code class="highlighter-rouge">config</code> directory.</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.pemcert_content</td>
      <td style="text-align: left">The content of the client certificate. Cannot be used when <code class="highlighter-rouge">pemcert_filepath</code> is set.</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.pemkey_filepath</td>
      <td style="text-align: left">Path to the private key of the client certificate. The file must be placed under the Open Distro for Elasticsearch <code class="highlighter-rouge">config</code> directory, and the path must be specified relative to the <code class="highlighter-rouge">config</code> directory.</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.pemkey_content</td>
      <td style="text-align: left">The content of the private key of your certificate. Cannot be used when <code class="highlighter-rouge">pemkey_filepath</code> is set.</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.pemkey_password</td>
      <td style="text-align: left">The password of your private key, if any.</td>
    </tr>
  </tbody>
</table>

<h3 id="enabled-ciphers-and-protocols">Enabled ciphers and protocols</h3>

<p>You can limit the allowed ciphers and TLS protocols for the IdP connection. For example, you can only enable strong ciphers and limit the TLS versions to the most recent ones.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">idp.enabled_ssl_ciphers</td>
      <td style="text-align: left">Array of enabled TLS ciphers. Only Java format is supported.</td>
    </tr>
    <tr>
      <td style="text-align: left">idp.enabled_ssl_protocols</td>
      <td style="text-align: left">Array of enabled TLS protocols. Only Java format is supported.</td>
    </tr>
  </tbody>
</table>

<h2 id="minimal-configuration-example">Minimal configuration example</h2>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">authc</span><span class="pi">:</span>
  <span class="na">saml_auth_domain</span><span class="pi">:</span>
    <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">saml</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">idp</span><span class="pi">:</span>
          <span class="na">metadata_file</span><span class="pi">:</span> <span class="s">metadata.xml</span>
          <span class="na">entity_id</span><span class="pi">:</span> <span class="s">http://idp.example.com/</span>
        <span class="na">sp</span><span class="pi">:</span>
          <span class="na">entity_id</span><span class="pi">:</span> <span class="s">https://kibana.example.com</span>
        <span class="na">kibana_url</span><span class="pi">:</span> <span class="s">https://kibana.example.com:5601/</span>
        <span class="na">roles_key</span><span class="pi">:</span> <span class="s">Role</span>
        <span class="na">exchange_key</span><span class="pi">:</span> <span class="s1">'</span><span class="s">peuvgOLrjzuhXf</span><span class="nv"> </span><span class="s">...'</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div>

<h2 id="kibana-configuration">Kibana configuration</h2>

<p>Since most of the SAML specific configuration is done in the Security plugin, just activate SAML in your <code class="highlighter-rouge">kibana.yml</code> by adding:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>opendistro_security.auth.type: "saml"
</code></pre></div></div>

<p>In addition, the Kibana endpoint for validating the SAML assertions must be whitelisted:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server.xsrf.whitelist: ["/_opendistro/_security/saml/acs"]
</code></pre></div></div>

<p>If you use the logout POST binding, you also need to whitelist the logout endpoint:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server.xsrf.whitelist: ["/_opendistro/_security/saml/acs", "/_opendistro/_security/saml/logout"]
</code></pre></div></div>


          
        </div>
      </div>
    </div>
  </div>
  
    <script>
      anchors.add();
    </script>
  
</body>
</html>

<!DOCTYPE html>

<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  

  <title>TLS Certificates - Open Distro for Elasticsearch Documentation</title>
  <link rel="stylesheet" href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/css/just-the-docs.css">
  <link rel="shortcut icon" href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/images/favicon.ico">

  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135423944-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-135423944-1');
    </script>
  

  
    <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/js/search-data.js"></script>
    <script src="https://unpkg.com/lunr/lunr.js"></script>
  

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
  

  <!-- SiteCatalyst code version: H.25.1. Copyright 1996-2012 Adobe, Inc. All Rights Reserved -->
  <script><!--
  /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
  var s_code=s.t();if(s_code)document.write(s_code)//--></script>
  <script language="JavaScript" type="text/javascript"><!--
  if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
  //--></script>
  <noscript>
  <img src="//amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazonalldev2/1/H.25.1--NS/0" height="1" width="1" border="0" alt="" />
  </noscript>
  <!--/DO NOT REMOVE/-->
  <!-- End SiteCatalyst code version: H.25.1. -->

  <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/" class="site-title"><img src="/for-elasticsearch-docs/old/0.9.0/assets/images/logo.svg"></a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list">
    
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/" class="navigation-list-link">About</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/" class="navigation-list-link">Install and Configure</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/docker/" class="navigation-list-link">Docker</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/rpm/" class="navigation-list-link">RPM</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/deb/" class="navigation-list-link">Debian Package</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/docker-security/" class="navigation-list-link">Docker Security Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/plugins/" class="navigation-list-link">Standalone Elasticsearch Plugin Install</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/other-components/" class="navigation-list-link">Other Components</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/install/encryption-at-rest/" class="navigation-list-link">Encryption at Rest</a>
                      
                    </li>
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/" class="navigation-list-link">Elasticsearch</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/configuration/" class="navigation-list-link">Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/index-data/" class="navigation-list-link">Index Data</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/full-text/" class="navigation-list-link">Full-Text Queries</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/elasticsearch/snapshot-restore/" class="navigation-list-link">Take and Restore Snapshots</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/" class="navigation-list-link">Kibana</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/plugins/" class="navigation-list-link">Standalone Kibana Plugin Install</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/kibana/maptiles/" class="navigation-list-link">WMS Map Server</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item active">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/" class="navigation-list-link">Security</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/concepts/" class="navigation-list-link">Basics</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/configuration/" class="navigation-list-link">Backend Configuration</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/security-admin/" class="navigation-list-link">Apply Configuration Changes</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item  active">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/tls-configuration/" class="navigation-list-link active">TLS Certificates</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/generate-certificates/" class="navigation-list-link">Generate Certificates</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/ldap/" class="navigation-list-link">Active Directory and LDAP</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/saml/" class="navigation-list-link">SAML</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/openid-connect/" class="navigation-list-link">OpenID Connect</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/default-action-groups/" class="navigation-list-link">Default Action Groups</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/permissions/" class="navigation-list-link">Permissions</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/document-level-security/" class="navigation-list-link">Document-Level Security</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/cross-cluster-search/" class="navigation-list-link">Cross-Cluster Search</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-logs/" class="navigation-list-link">Audit Logs</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-log-storage-types/" class="navigation-list-link">Audit Log Storage Types</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/audit-logs-field-reference/" class="navigation-list-link">Audit Log Field Reference</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/disable/" class="navigation-list-link">Disable Security</a>
                      
                    </li>
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/" class="navigation-list-link">Alerting</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/monitors/" class="navigation-list-link">Monitors</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/settings/" class="navigation-list-link">Management</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/security-roles/" class="navigation-list-link">Security Roles</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/alerting/cron/" class="navigation-list-link">Cron</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/" class="navigation-list-link">SQL</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/operations/" class="navigation-list-link">Supported Operations</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/jdbc/" class="navigation-list-link">JDBC Driver</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/sql/joins/" class="navigation-list-link">Joins</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/" class="navigation-list-link">Performance Analyzer</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/api/" class="navigation-list-link">API</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/dashboards/" class="navigation-list-link">Create Dashboards</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/pa/reference/" class="navigation-list-link">Metrics Reference</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/troubleshoot/" class="navigation-list-link">Troubleshoot</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
  </ul>
</nav>

      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-100">See a problem? Submit <a href="https://github.com/opendistro/for-elasticsearch-docs/issues">issues</a> or <a href="https://github.com/opendistro/for-elasticsearch-docs/pulls">pull requests</a> on <a href="https://github.com/opendistro/for-elasticsearch-docs">GitHub</a>.</p>
        <p class="text-small text-grey-dk-100 mb-0">© 2020 Amazon Web Services, Inc. or its affiliates. All rights reserved.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          <div class="search js-search">
            <div class="search-input-wrap">
              <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search..." aria-label="Search" autocomplete="off">
              <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg>
            </div>
            <div class="js-search-results search-results-wrap"></div>
          </div>
          
          
            <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
              
                <li class="d-inline-block my-0"><a href="https://opendistro.github.io/for-elasticsearch/">Back to the Open Distro for Elasticsearch home page</a></li>
              
            </ul>
          
        </div>
      </div>
      <div class="main-content">
        
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                  <li class="breadcrumb-nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/0.9.0/docs/security/">Security</a></li>
                
                <li class="breadcrumb-nav-list-item"><span>TLS Certificates</span></li>
              </ol>
            </nav>
          
        
        <div id="main-content" class="page-content" role="main">
          <h1 id="configure-tls-certificates">Configure TLS certificates</h1>

<p>TLS is configured in <code class="highlighter-rouge">elasticsearch.yml</code>. There are two main configuration sections: transport layer and REST layer. TLS is optional for the REST layer and mandatory for the transport layer.</p>

<p class="note">You can find an example configuration template with all options on <a href="https://www.github.com/opendistro-for-elasticsearch/security-ssl/blob/master/opendistrosecurity-ssl-config-template.yml">GitHub</a>.</p>

<hr />

<h4 id="table-of-contents">Table of contents</h4>
<ol id="markdown-toc">
  <li><a href="#x509-pem-certificates-and-pkcs-8-keys" id="markdown-toc-x509-pem-certificates-and-pkcs-8-keys">X.509 PEM certificates and PKCS #8 keys</a>    <ol>
      <li><a href="#transport-layer-tls" id="markdown-toc-transport-layer-tls">Transport layer TLS</a></li>
      <li><a href="#rest-layer-tls" id="markdown-toc-rest-layer-tls">REST layer TLS</a></li>
    </ol>
  </li>
  <li><a href="#keystore-and-truststore-files" id="markdown-toc-keystore-and-truststore-files">Keystore and truststore files</a>    <ol>
      <li><a href="#transport-layer-tls-1" id="markdown-toc-transport-layer-tls-1">Transport layer TLS</a></li>
      <li><a href="#rest-layer-tls-1" id="markdown-toc-rest-layer-tls-1">REST layer TLS</a></li>
    </ol>
  </li>
  <li><a href="#configure-node-certificates" id="markdown-toc-configure-node-certificates">Configure node certificates</a></li>
  <li><a href="#configure-admin-certificates" id="markdown-toc-configure-admin-certificates">Configure admin certificates</a></li>
  <li><a href="#openssl" id="markdown-toc-openssl">OpenSSL</a></li>
  <li><a href="#advanced-hostname-verification-and-dns-lookup" id="markdown-toc-advanced-hostname-verification-and-dns-lookup">(Advanced) Hostname verification and DNS lookup</a></li>
  <li><a href="#advanced-client-authentication" id="markdown-toc-advanced-client-authentication">(Advanced) Client authentication</a></li>
  <li><a href="#advanced-enabled-ciphers-and-protocols" id="markdown-toc-advanced-enabled-ciphers-and-protocols">(Advanced) Enabled ciphers and protocols</a>    <ol>
      <li><a href="#example-settings" id="markdown-toc-example-settings">Example settings</a></li>
    </ol>
  </li>
  <li><a href="#advanced-disable-client-initiated-renegotiation-for-java-8" id="markdown-toc-advanced-disable-client-initiated-renegotiation-for-java-8">(Advanced) Disable client initiated renegotiation for Java 8</a></li>
</ol>

<hr />

<h2 id="x509-pem-certificates-and-pkcs-8-keys">X.509 PEM certificates and PKCS #8 keys</h2>

<p>The following tables contain the settings you can use to configure the location of your PEM certificates and private keys.</p>

<h3 id="transport-layer-tls">Transport layer TLS</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.pemkey_filepath</td>
      <td style="text-align: left">Path to the certificate’s key file (PKCS #8), which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.pemkey_password</td>
      <td style="text-align: left">Key password. Omit this setting if the key has no password. Optional.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.pemcert_filepath</td>
      <td style="text-align: left">Path to the X.509 node certificate chain (PEM format), which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.pemtrustedcas_filepath</td>
      <td style="text-align: left">Path to the root CA(s) (PEM format), which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path . Required.</td>
    </tr>
  </tbody>
</table>

<h3 id="rest-layer-tls">REST layer TLS</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.pemkey_filepath</td>
      <td style="text-align: left">Path to the certificate’s key file (PKCS #8), which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.pemkey_password</td>
      <td style="text-align: left">Key password. Omit this setting if the key has no password. Optional.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.pemcert_filepath</td>
      <td style="text-align: left">Path to the X.509 node certificate chain (PEM format), which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.pemtrustedcas_filepath</td>
      <td style="text-align: left">Path to the root CA(s) (PEM format), which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path . Required.</td>
    </tr>
  </tbody>
</table>

<h2 id="keystore-and-truststore-files">Keystore and truststore files</h2>

<p>As an alternative to certificates and private keys in PEM format, you can instead use keystore and truststore files in JKS or PKCS12/PFX format. The following settings configure the location and password of your keystore and truststore files. If desired, you can use different keystore and truststore files for the REST and the transport layer.</p>

<h3 id="transport-layer-tls-1">Transport layer TLS</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.keystore_type</td>
      <td style="text-align: left">The type of the keystore file, JKS or PKCS12/PFX. Optional. Default is JKS.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.keystore_filepath</td>
      <td style="text-align: left">Path to the keystore file, which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.keystore_alias: my_alias</td>
      <td style="text-align: left">Alias name. Optional. Default is the first alias.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.keystore_password</td>
      <td style="text-align: left">Keystore password. Default is <code class="highlighter-rouge">changeit</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.truststore_type</td>
      <td style="text-align: left">The type of the truststore file, JKS or PKCS12/PFX. Default is JKS.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.truststore_filepath</td>
      <td style="text-align: left">Path to the truststore file, which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.truststore_alias</td>
      <td style="text-align: left">Alias name. Optional. Default is all certificates.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.truststore_password</td>
      <td style="text-align: left">Truststore password. Default is <code class="highlighter-rouge">changeit</code>.</td>
    </tr>
  </tbody>
</table>

<h3 id="rest-layer-tls-1">REST layer TLS</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.enabled</td>
      <td style="text-align: left">Whether to enable TLS on the REST layer. If enabled, only HTTPS is allowed. Optional. Default is false.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.keystore_type</td>
      <td style="text-align: left">The type of the keystore file, JKS or PKCS12/PFX. Optional. Default is JKS.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.keystore_filepath</td>
      <td style="text-align: left">Path to the keystore file, which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.keystore_alias</td>
      <td style="text-align: left">Alias name. Optional. Default is the first alias.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.keystore_password</td>
      <td style="text-align: left">Keystore password. Default is <code class="highlighter-rouge">changeit</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.truststore_type</td>
      <td style="text-align: left">The type of the truststore file, JKS or PKCS12/PFX. Default is JKS.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.truststore_filepath</td>
      <td style="text-align: left">Path to the truststore file, which must be under the <code class="highlighter-rouge">config/</code> directory, specified using a relative path. Required.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.truststore_alias</td>
      <td style="text-align: left">Alias name. Optional. Default is all certificates.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.truststore_password</td>
      <td style="text-align: left">Truststore password. Default is <code class="highlighter-rouge">changeit</code>.</td>
    </tr>
  </tbody>
</table>

<h2 id="configure-node-certificates">Configure node certificates</h2>

<p>The Security plugin needs to identify inter-cluster requests (i.e. requests between the nodes). The simplest way of configuring node certificates is to list the Distinguished Names (DNs) of these certificates in <code class="highlighter-rouge">elasticsearch.yml</code>. The Security plugin supports wildcards and regular expressions:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">opendistro_security.nodes_dn</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">CN=node.other.com,OU=SSL,O=Test,L=Test,C=DE'</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">CN=*.example.com,OU=SSL,O=Test,L=Test,C=DE'</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">CN=elk-devcluster*'</span>
  <span class="pi">-</span> <span class="s1">'</span><span class="s">/CN=.*regex/'</span>
</code></pre></div></div>

<p>If your node certificates have an OID identifier in the SAN section, you can omit this configuration.</p>

<h2 id="configure-admin-certificates">Configure admin certificates</h2>

<p>Admin certificates are regular client certificates that have elevated rights to perform administrative tasks. You need an admin certificate to change the the Security plugin configuration using <code class="highlighter-rouge">plugins/opendistro_security/tools/securityadmin.sh</code> or the REST API. Admin certificates are configured in <code class="highlighter-rouge">elasticsearch.yml</code> by stating their DN(s):</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">opendistro_security.authcz.admin_dn</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">CN=admin,OU=SSL,O=Test,L=Test,C=DE</span>
</code></pre></div></div>

<p>For security reasons, you cannot use wildcards nor regular expressions here.</p>

<h2 id="openssl">OpenSSL</h2>

<p>The Security plugin supports OpenSSL. We recommend OpenSSL in production for enhanced performance and a wider range of modern cipher suites. In order to use OpenSSL, you need to install OpenSSL, the Apache Portable Runtime, and a Netty version with OpenSSL support matching your platform on all nodes.</p>

<p>If OpenSSL is enabled, but for one reason or another the installation does not work, the Security plugin falls back to the Java JCE as the security engine.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.enable_openssl_if_available</td>
      <td style="text-align: left">Enable OpenSSL on the transport layer if available. Optional. Default is true.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.enable_openssl_if_available</td>
      <td style="text-align: left">Enable OpenSSL on the REST layer if available. Optional. Default is true.</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>Install <a href="https://www.openssl.org/community/binaries.html">OpenSSL 1.1.0</a> on every node.</li>
  <li>Install <a href="https://apr.apache.org">Apache Portable Runtime </a> on every node:</li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  sudo yum install apr
</code></pre></div></div>

<ol>
  <li>Download <a href="https://netty.io/wiki/forked-tomcat-native.html">netty-tcnative</a> for RPM-based distributions (<code class="highlighter-rouge">_linux-x86_64-fedora.jar_</code>) and place it into <code class="highlighter-rouge">plugins/opendistro_security/</code> on every node.</li>
</ol>

<h2 id="advanced-hostname-verification-and-dns-lookup">(Advanced) Hostname verification and DNS lookup</h2>

<p>In addition to verifying the TLS certificates against the root CA and/or intermediate CA(s), the Security plugin can apply additional checks on the transport layer.</p>

<p>With <code class="highlighter-rouge">enforce_hostname_verification</code> enabled, the Security plugin verifies that the hostname of the communication partner matches the hostname in the certificate. The hostname is taken from the <code class="highlighter-rouge">subject</code> or <code class="highlighter-rouge">SAN</code> entries of your certificate. For example, if the hostname of your node is <code class="highlighter-rouge">node-0.example.com</code>, then the hostname in the TLS certificate has to be set to <code class="highlighter-rouge">node-0.example.com</code>, as well. Otherwise, errors are thrown:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ERROR][c.a.o.s.s.t.OpenDistroSecuritySSLNettyTransport] [WX6omJY] SSL Problem No name matching &lt;hostname&gt; found
[ERROR][c.a.o.s.s.t.OpenDistroSecuritySSLNettyTransport] [WX6omJY] SSL Problem Received fatal alert: certificate_unknown
</code></pre></div></div>

<p>In addition, when <code class="highlighter-rouge">resolve_hostnames</code> is enabled, the Security plugin resolves the (verified) hostname against your DNS. If the hostname does not resolve, errors are thrown:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.enforce_hostname_verification</td>
      <td style="text-align: left">Whether to verify hostnames on the transport layer. Optional. Default is true.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.resolve_hostname</td>
      <td style="text-align: left">Whether to resolve hostnames against DNS on the transport layer. Optional. Default is true. Only works if hostname verification is also enabled.</td>
    </tr>
  </tbody>
</table>

<h2 id="advanced-client-authentication">(Advanced) Client authentication</h2>

<p>With TLS client authentication enabled, REST clients can send a TLS certificate with the HTTP request to provide identity information to the Security plugin. There are three main usage scenarios for TLS client authentication:</p>

<ul>
  <li>Providing an admin certificate when using the REST management API.</li>
  <li>Configuring roles and permissions based on a client certificate.</li>
  <li>Providing identity information for tools like Kibana, Logstash or Beats.</li>
</ul>

<p>TLS client authentication has three modes:</p>

<ul>
  <li><code class="highlighter-rouge">NONE</code>: The Security plugin does not accept TLS client certificates. If one is sent, it is discarded.</li>
  <li><code class="highlighter-rouge">OPTIONAL</code>: The Security plugin accepts TLS client certificates if they are sent, but does not require them.</li>
  <li><code class="highlighter-rouge">REQUIRE</code>: The Security plugin only accepts REST requests when a valid client TLS certificate is sent.</li>
</ul>

<p>For the REST management API, the client authentication modes has to be OPTIONAL at a minimum.</p>

<p>You can configure the client authentication mode by using the following setting:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.clientauth_mode</td>
      <td style="text-align: left">The TLS client authentication mode to use. Can be one of <code class="highlighter-rouge">NONE</code>, <code class="highlighter-rouge">OPTIONAL</code> (default) or <code class="highlighter-rouge">REQUIRE</code>. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="advanced-enabled-ciphers-and-protocols">(Advanced) Enabled ciphers and protocols</h2>

<p>You can limit the allowed ciphers and TLS protocols for the REST layer. For example, you can only allow strong ciphers and limit the TLS versions to the most recent ones.</p>

<p>If this setting is not enabled, the ciphers and TLS versions are negotiated between the browser and the Security plugin automatically, which in some cases can lead to a weaker cipher suite being used. You can configure the ciphers and protocols using the following settings.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.enabled_ciphers</td>
      <td style="text-align: left">Array, enabled TLS cipher suites for the REST layer. Only Java format is supported.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.http.enabled_protocols</td>
      <td style="text-align: left">Array, enabled TLS protocols for the REST layer. Only Java format is supported.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.enabled_ciphers</td>
      <td style="text-align: left">Array, enabled TLS cipher suites for the transport layer. Only Java format is supported.</td>
    </tr>
    <tr>
      <td style="text-align: left">opendistro_security.ssl.transport.enabled_protocols</td>
      <td style="text-align: left">Array, enabled TLS protocols for the transport layer. Only Java format is supported.</td>
    </tr>
  </tbody>
</table>

<h3 id="example-settings">Example settings</h3>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">opendistro_security.ssl.http.enabled_ciphers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">TLS_DHE_RSA_WITH_AES_256_CBC_SHA"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">TLS_DHE_DSS_WITH_AES_128_CBC_SHA256"</span>
<span class="s">opendistro_security.ssl.http.enabled_protocols</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">TLSv1.1"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">TLSv1.2"</span>
</code></pre></div></div>

<p>Because it is insecure, the Security plugin disables <code class="highlighter-rouge">TLSv1</code> by default. If you need to use <code class="highlighter-rouge">TLSv1</code> and accept the risks, you can still enable it:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">opendistro_security.ssl.http.enabled_protocols</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">TLSv1"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">TLSv1.1"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">TLSv1.2"</span>
</code></pre></div></div>

<h2 id="advanced-disable-client-initiated-renegotiation-for-java-8">(Advanced) Disable client initiated renegotiation for Java 8</h2>

<p>Set <code class="highlighter-rouge">-Djdk.tls.rejectClientInitiatedRenegotiation=true</code> to disable secure client initiated renegotiation, which is enabled by default. This can be set via <code class="highlighter-rouge">ES_JAVA_OPTS</code> in <code class="highlighter-rouge">config/jvm.options</code>.</p>


          
        </div>
      </div>
    </div>
  </div>
  
    <script>
      anchors.add();
    </script>
  
</body>
</html>

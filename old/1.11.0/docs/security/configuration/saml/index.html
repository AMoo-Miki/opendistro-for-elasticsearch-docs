<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>SAML - Open Distro for Elasticsearch Documentation</title> <link rel="shortcut icon" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135423944-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-135423944-1'); </script> <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>SAML | Open Distro for Elasticsearch Documentation</title> <meta name="generator" content="Jekyll v3.8.6" /> <meta property="og:title" content="SAML" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more." /> <meta property="og:description" content="Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more." /> <link rel="canonical" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/saml/" /> <meta property="og:url" content="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/saml/" /> <meta property="og:site_name" content="Open Distro for Elasticsearch Documentation" /> <script type="application/ld+json"> {"description":"Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more.","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/images/logo.svg"}},"url":"https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/saml/","headline":"SAML","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script> <!-- SiteCatalyst code version: H.25.1. Copyright 1996-2012 Adobe, Inc. All Rights Reserved --> <script><!-- /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/ var s_code=s.t();if(s_code)document.write(s_code)//--></script> <script language="JavaScript" type="text/javascript"><!-- if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-') //--></script> <noscript> <img src="//amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazonalldev2/1/H.25.1--NS/0" height="1" width="1" border="0" alt="" /> </noscript> <!--/DO NOT REMOVE/--> <!-- End SiteCatalyst code version: H.25.1. --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/version-history/" class="nav-list-link">Version History</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/" class="nav-list-link">Install and Configure</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/docker/" class="nav-list-link">Docker</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/rpm/" class="nav-list-link">RPM</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/deb/" class="nav-list-link">Debian Package</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/helm/" class="nav-list-link">Helm</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/tar/" class="nav-list-link">Tarball</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/windows/" class="nav-list-link">Windows</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/docker-security/" class="nav-list-link">Docker Security Configuration</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/plugins/" class="nav-list-link">Standalone Elasticsearch Plugin Install</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/ami/" class="nav-list-link">Amazon Machine Image</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/other-components/" class="nav-list-link">Other Components</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/encryption-at-rest/" class="nav-list-link">Encryption at Rest</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/" class="nav-list-link">Upgrade</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-0-0/" class="nav-list-link">Upgrade to 1.x.x</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-11.0/" class="nav-list-link">Upgrade to 1.11.0</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-10-1/" class="nav-list-link">Upgrade to 1.10.1</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-8-0/" class="nav-list-link">Upgrade to 1.8.0</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/rolling/" class="nav-list-link">Rolling Upgrade</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/cluster-restart/" class="nav-list-link">Cluster Restart Upgrade</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/docker/" class="nav-list-link">Docker Upgrade</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/" class="nav-list-link">Elasticsearch</a><ul class="nav-list "><li class="nav-list-item active"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/configuration/" class="nav-list-link">Configuration</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/cluster/" class="nav-list-link">Cluster Formation</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-data/" class="nav-list-link">Index Data</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-alias/" class="nav-list-link">Index Aliases</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-templates/" class="nav-list-link">Index Templates</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/reindex-data/" class="nav-list-link">Reindex Data</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/catapis/" class="nav-list-link">CAT API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/term/" class="nav-list-link">Term-Level Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/full-text/" class="nav-list-link">Full-Text Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/search-template/" class="nav-list-link">Search Templates</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/bool/" class="nav-list-link">Boolean Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/ux/" class="nav-list-link">Search Experience</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/logs/" class="nav-list-link">Logs</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/snapshot-restore/" class="nav-list-link">Take and Restore Snapshots</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/units/" class="nav-list-link">Supported Units</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/common-parameters/" class="nav-list-link">Common REST Parameters</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/popular-api/" class="nav-list-link">Popular APIs</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/rest-api-reference/" class="nav-list-link">REST API Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/" class="nav-list-link">Kibana</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/plugins/" class="nav-list-link">Standalone Kibana Plugin Install</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/maptiles/" class="nav-list-link">WMS Map Server</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/" class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/" class="nav-list-link">Configuration</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/concepts/" class="nav-list-link">Authentication flow</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/configuration/" class="nav-list-link">Backend Configuration</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/yaml/" class="nav-list-link">YAML Files</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/tls/" class="nav-list-link">TLS Certificates</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/generate-certificates/" class="nav-list-link">Generate Certificates</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/security-admin/" class="nav-list-link">Apply Changes with securityadmin.sh</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/ldap/" class="nav-list-link">Active Directory and LDAP</a> </li><li class="nav-list-item active"> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/saml/" class="nav-list-link active">SAML</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/openid-connect/" class="nav-list-link">OpenID Connect</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/proxy/" class="nav-list-link">Proxy-based authentication</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/disable/" class="nav-list-link">Disable Security</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/" class="nav-list-link">Access Control</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/users-roles/" class="nav-list-link">Users and Roles</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/document-level-security/" class="nav-list-link">Document-Level Security</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/field-level-security/" class="nav-list-link">Field-Level Security</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/field-masking/" class="nav-list-link">Field Masking</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/impersonation/" class="nav-list-link">User Impersonation</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/multi-tenancy/" class="nav-list-link">Kibana Multi-Tenancy</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/cross-cluster-search/" class="nav-list-link">Cross-Cluster Search</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/permissions/" class="nav-list-link">Permissions</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/default-action-groups/" class="nav-list-link">Default Action Groups</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/api/" class="nav-list-link">API</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/" class="nav-list-link">Audit Logs</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/field-reference/" class="nav-list-link">Audit Log Field Reference</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/storage-types/" class="nav-list-link">Audit Log Storage Types</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/" class="nav-list-link">Alerting</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/monitors/" class="nav-list-link">Monitors</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/settings/" class="nav-list-link">Management</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/security-roles/" class="nav-list-link">Security Roles</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/cron/" class="nav-list-link">Cron</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/" class="nav-list-link">SQL</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/workbench/" class="nav-list-link">Workbench</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/cli/" class="nav-list-link">SQL CLI</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/basic/" class="nav-list-link">Basic Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/complex/" class="nav-list-link">Complex Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/partiql/" class="nav-list-link">JSON Support</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/sql-full-text/" class="nav-list-link">Full-Text Search</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/metadata/" class="nav-list-link">Metadata Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/functions/" class="nav-list-link">Functions</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/window/" class="nav-list-link">Window Functions</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/delete/" class="nav-list-link">Delete</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/endpoints/" class="nav-list-link">Endpoint</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/protocol/" class="nav-list-link">Protocol</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/monitoring/" class="nav-list-link">Monitoring</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/troubleshoot/" class="nav-list-link">Troubleshooting</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/limitation/" class="nav-list-link">Limitations</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/jdbc/" class="nav-list-link">JDBC Driver</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/odbc/" class="nav-list-link">ODBC Driver</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/" class="nav-list-link">PPL</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/endpoint/" class="nav-list-link">Endpoint</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/protocol/" class="nav-list-link">Protocol</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/commands/" class="nav-list-link">Commands</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/functions/" class="nav-list-link">Functions</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/" class="nav-list-link">Index State Management</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/policies/" class="nav-list-link">Policies</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/managedindices/" class="nav-list-link">Managed Indices</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/api/" class="nav-list-link">ISM API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/refresh-analyzer/" class="nav-list-link">Refresh Search Analyzer</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/knn/" class="nav-list-link">KNN</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/knn/settings/" class="nav-list-link">Settings and Statistics</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/" class="nav-list-link">Anomaly Detection</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/api/" class="nav-list-link">Anomaly Detection API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/cli/" class="nav-list-link">Anomaly Detection CLI</a></li></ul></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/notebooks/" class="nav-list-link">Notebooks</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/" class="nav-list-link">Performance Analyzer</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/dashboards/" class="nav-list-link">Create Dashboards</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/reference/" class="nav-list-link">Metrics Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/" class="nav-list-link">Root Cause Analysis</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/reference/" class="nav-list-link">RCA Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/" class="nav-list-link">Troubleshoot</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/tls/" class="nav-list-link">Troubleshoot TLS</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/saml/" class="nav-list-link">Troubleshoot SAML</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/openid-connect/" class="nav-list-link">Troubleshoot OpenID Connect</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/security-admin/" class="nav-list-link">Troubleshoot securityadmin.sh</a></li></ul></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/other/" class="nav-list-link">Other Resources</a></li></ul> </nav> <footer class="site-footer"> <p class="text-small text-grey-dk-100">See a problem? Submit <a href="https://github.com/opendistro/for-elasticsearch-docs/issues">issues</a> or <a href="https://github.com/opendistro/for-elasticsearch-docs/edit/master/docs/security/configuration/saml.md">edit this page</a> on <a href="https://github.com/opendistro/for-elasticsearch-docs">GitHub</a>.</p> <p class="text-small text-grey-dk-100 mb-0">© 2020 Amazon Web Services, Inc. or its affiliates. All rights reserved.</p> </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search..." aria-label="Search Open Distro for Elasticsearch Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://opendistro.github.io/for-elasticsearch/" class="site-button" > Open Distro for Elasticsearch home </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/">Security</a></li> <li class="breadcrumb-nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/">Configuration</a></li> <li class="breadcrumb-nav-list-item"><span>SAML</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="saml">SAML</h1> <p>The security plugin supports user authentication through SAML single sign-on. The security plugin implements the web browser SSO profile of the SAML 2.0 protocol.</p> <p>This profile is meant for use with web browsers. It is not a general-purpose way of authenticating users against the security plugin, so its primary use case is to support Kibana single sign-on.</p> <h2 id="docker-example">Docker example</h2> <p>We provide a fully functional example that can help you understand how to use SAML with Kibana.</p> <ol> <li>Download and unzip <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/examples/saml-example.zip">the example ZIP file</a>.</li> <li>At the command line, run <code class="highlighter-rouge">docker-compose up</code>.</li> <li> <p>Review the files:</p> <ul> <li><code class="highlighter-rouge">docker-compose.yml</code> defines two ODFE nodes, a Kibana server, and a SAML server.</li> <li><code class="highlighter-rouge">custom-kibana.yml</code> add a few SAML settings to the default <code class="highlighter-rouge">kibana.yml</code> file.</li> <li><code class="highlighter-rouge">config.yml</code> configures SAML for authentication.</li> </ul> </li> <li> <p>Access Kibana at <a href="http://localhost:5601" target="\_blank">http://localhost:5601</a>. Note that Kibana immediately redirects you to the SAML login page.</p> </li> <li> <p>Log in as <code class="highlighter-rouge">admin</code> with a password of <code class="highlighter-rouge">admin</code>.</p> </li> <li> <p>After logging in, note that your user in the upper-right is <code class="highlighter-rouge">SAMLAdmin</code>, as defined in <code class="highlighter-rouge">/var/www/simplesamlphp/config/authsources.php</code> of the SAML server.</p> </li> <li> <p>If you want to examine the SAML server, run <code class="highlighter-rouge">docker ps</code> to find its container ID and then <code class="highlighter-rouge">docker exec -it &lt;container-id&gt; /bin/bash</code>.</p> <p>In particular, you might find it helpful to review the contents of the <code class="highlighter-rouge">/var/www/simplesamlphp/config/</code> and <code class="highlighter-rouge">/var/www/simplesamlphp/metadata/</code> directories.</p> </li> </ol> <h2 id="activating-saml">Activating SAML</h2> <p>To use SAML for authentication, you need to configure a respective authentication domain in the <code class="highlighter-rouge">authc</code> section of <code class="highlighter-rouge">plugins/opendistro_security/securityconfig/config.yml</code>. Because SAML works solely on the HTTP layer, you do not need any <code class="highlighter-rouge">authentication_backend</code> and can set it to <code class="highlighter-rouge">noop</code>. Place all SAML-specific configuration options in this chapter in the <code class="highlighter-rouge">config</code> section of the SAML HTTP authenticator:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">authc</span><span class="pi">:</span>
  <span class="na">saml_auth_domain</span><span class="pi">:</span>
    <span class="na">http_enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">transport_enabled</span><span class="pi">:</span> <span class="no">false</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">saml</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">idp</span><span class="pi">:</span>
          <span class="na">metadata_file</span><span class="pi">:</span> <span class="s">okta.xml</span>
          <span class="s">...</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div> <p>After you have configured SAML in <code class="highlighter-rouge">config.yml</code>, you must also <a href="#kibana-configuration">activate it in Kibana</a>.</p> <h2 id="running-multiple-authentication-domains">Running multiple authentication domains</h2> <p>We recommend adding at least one other authentication domain, such as LDAP or the internal user database, to support API access to Elasticsearch without SAML. For Kibana and the internal Kibana server user, you also must add another authentication domain that supports basic authentication. This authentication domain should be placed first in the chain, and the <code class="highlighter-rouge">challenge</code> flag must be set to <code class="highlighter-rouge">false</code>:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">authc</span><span class="pi">:</span>
  <span class="na">basic_internal_auth_domain</span><span class="pi">:</span>
    <span class="na">http_enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">transport_enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">0</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">basic</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">false</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">internal</span>
  <span class="na">saml_auth_domain</span><span class="pi">:</span>
    <span class="na">http_enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">transport_enabled</span><span class="pi">:</span> <span class="no">false</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">saml</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="s">...</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div> <h2 id="identity-provider-metadata">Identity provider metadata</h2> <p>A SAML identity provider (IdP) provides a SAML 2.0 metadata file describing the IdP’s capabilities and configuration. The security plugin can read IdP metadata either from a URL or a file. The choice that you make depends on your IdP and your preferences. The SAML 2.0 metadata file is required.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.metadata_file</code></td> <td style="text-align: left">The path to the SAML 2.0 metadata file of your IdP. Place the metadata file in the <code class="highlighter-rouge">config</code> directory of Open Distro for Elasticsearch. The path has to be specified relative to the <code class="highlighter-rouge">config</code> directory. Required if <code class="highlighter-rouge">idp.metadata_url</code> is not set.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.metadata_url</code></td> <td style="text-align: left">The SAML 2.0 metadata URL of your IdP. Required if <code class="highlighter-rouge">idp.metadata_file</code> is not set.</td> </tr> </tbody> </table></div> <h2 id="idp-and-service-provider-entity-id">IdP and service provider entity ID</h2> <p>An entity ID is a globally unique name for a SAML entity, either an IdP or a service provider (SP). The IdP entity ID is usually provided by your IdP. The SP entity ID is the name of the configured application or client in your IdP. We recommend adding a new application for Kibana and using the URL of your Kibana installation as the SP entity ID.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.entity_id</code></td> <td style="text-align: left">The entity ID of your IdP. Required.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">sp.entity_id</code></td> <td style="text-align: left">The entity ID of the service provider. Required.</td> </tr> </tbody> </table></div> <h2 id="kibana-settings">Kibana settings</h2> <p>The Web Browser SSO Profile exchanges information through HTTP GET or POST. For example, after you log in to your IdP, it sends an HTTP POST back to Kibana containing the SAML response. You must configure the base URL of your Kibana installation where the HTTP requests are being sent to.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">kibana_url</code></td> <td style="text-align: left">The Kibana base URL. Required.</td> </tr> </tbody> </table></div> <h2 id="username-and-role-attributes">Username and Role attributes</h2> <p>Subjects (for example, user names) are usually stored in the <code class="highlighter-rouge">NameID</code> element of a SAML response:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;saml2:Subject&gt;
  &lt;saml2:NameID&gt;admin&lt;/saml2:NameID&gt;
  ...
&lt;/saml2:Subject&gt;
</code></pre></div></div> <p>If your IdP is compliant with the SAML 2.0 specification, you do not need to set anything special. If your IdP uses a different element name, you can also specify its name explicitly.</p> <p>Role attributes are optional. However, most IdPs can be configured to add roles in the SAML assertions as well. If present, you can use these roles in your <a href="../concepts">role mappings</a>:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;saml2:Attribute Name='Role'&gt;
  &lt;saml2:AttributeValue &gt;Everyone&lt;/saml2:AttributeValue&gt;
  &lt;saml2:AttributeValue &gt;Admins&lt;/saml2:AttributeValue&gt;
&lt;/saml2:Attribute&gt;
</code></pre></div></div> <p>If you want to extract roles from the SAML response, you need to specify the element name that contains the roles.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">subject_key</code></td> <td style="text-align: left">The attribute in the SAML response where the subject is stored. Optional. If not configured, the <code class="highlighter-rouge">NameID</code> attribute is used.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">roles_key</code></td> <td style="text-align: left">The attribute in the SAML response where the roles are stored. Optional. If not configured, no roles are used.</td> </tr> </tbody> </table></div> <h2 id="request-signing">Request signing</h2> <p>Requests from the security plugin to the IdP can optionally be signed. Use the following settings to configure request signing.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">sp.signature_private_key</code></td> <td style="text-align: left">The private key used to sign the requests or to decode encrypted assertions. Optional. Cannot be used when <code class="highlighter-rouge">private_key_filepath</code> is set.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">sp.signature_private_key_password</code></td> <td style="text-align: left">The password of the private key, if any.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">sp.signature_private_key_filepath</code></td> <td style="text-align: left">Path to the private key. The file must be placed under the Open Distro for Elasticsearch <code class="highlighter-rouge">config</code> directory, and the path must be specified relative to that same directory.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">sp.signature_algorithm</code></td> <td style="text-align: left">The algorithm used to sign the requests. See the next table for possible values.</td> </tr> </tbody> </table></div> <p>The security plugin supports the following signature algorithms.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Algorithm</th> <th style="text-align: left">Value</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">DSA_SHA1</td> <td style="text-align: left">http://www.w3.org/2000/09/xmldsig#dsa-sha1;</td> </tr> <tr> <td style="text-align: left">RSA_SHA1</td> <td style="text-align: left">http://www.w3.org/2000/09/xmldsig#rsa-sha1;</td> </tr> <tr> <td style="text-align: left">RSA_SHA256</td> <td style="text-align: left">http://www.w3.org/2001/04/xmldsig-more#rsa-sha256;</td> </tr> <tr> <td style="text-align: left">RSA_SHA384</td> <td style="text-align: left">http://www.w3.org/2001/04/xmldsig-more#rsa-sha384;</td> </tr> <tr> <td style="text-align: left">RSA_SHA512</td> <td style="text-align: left">http://www.w3.org/2001/04/xmldsig-more#rsa-sha512;</td> </tr> </tbody> </table></div> <h2 id="logout">Logout</h2> <p>Usually, IdPs provide information about their individual logout URL in their SAML 2.0 metadata. If this is the case, the security plugin uses them to render the correct logout link in Kibana. If your IdP does not support an explicit logout, you can force a re-login when the user visits Kibana again.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">sp.forceAuthn</code></td> <td style="text-align: left">Force a re-login even if the user has an active session with the IdP.</td> </tr> </tbody> </table></div> <p>Currently, the security plugin supports only the <code class="highlighter-rouge">HTTP-Redirect</code> logout binding. Make sure this is configured correctly in your IdP.</p> <h2 id="exchange-key-settings">Exchange key settings</h2> <p>SAML, unlike other protocols, is not meant to be used for exchanging user credentials with each request. The security plugin trades the SAML response for a lightweight JSON web token that stores the validated user attributes. This token is signed by an exchange key that you can choose freely. Note that when you change this key, all tokens signed with it become invalid immediately.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">exchange_key</code></td> <td style="text-align: left">The key to sign the token. The algorithm is HMAC256, so it should have at least 32 characters.</td> </tr> </tbody> </table></div> <h2 id="tls-settings">TLS settings</h2> <p>If you are loading the IdP metadata from a URL, we recommend that you use SSL/TLS. If you use an external IdP like Okta or Auth0 that uses a trusted certificate, you usually do not need to configure anything. If you host the IdP yourself and use your own root CA, you can customize the TLS settings as follows. These settings are used only for loading SAML metadata over HTTPS.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.enable_ssl</code></td> <td style="text-align: left">Whether to enable the custom TLS configuration. Default is false (JDK settings are used).</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.verify_hostnames</code></td> <td style="text-align: left">Whether to verify the hostnames of the server’s TLS certificate.</td> </tr> </tbody> </table></div> <p>Example:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">authc</span><span class="pi">:</span>
  <span class="na">saml_auth_domain</span><span class="pi">:</span>
    <span class="na">http_enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">transport_enabled</span><span class="pi">:</span> <span class="no">false</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">saml</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">idp</span><span class="pi">:</span>
          <span class="na">enable_ssl</span><span class="pi">:</span> <span class="no">true</span>
          <span class="na">verify_hostnames</span><span class="pi">:</span> <span class="no">true</span>
          <span class="s">...</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div> <h3 id="certificate-validation">Certificate validation</h3> <p>Configure the root CA used for validating the IdP TLS certificate by setting <strong>one</strong> of the following configuration options:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">idp</span><span class="pi">:</span>
    <span class="na">pemtrustedcas_filepath</span><span class="pi">:</span> <span class="s">path/to/trusted_cas.pem</span>
</code></pre></div></div> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">idp</span><span class="pi">:</span>
    <span class="na">pemtrustedcas_content</span><span class="pi">:</span> <span class="pi">|-</span>
      <span class="s">MIID/jCCAuagAwIBAgIBATANBgkqhkiG9w0BAQUFADCBjzETMBEGCgmSJomT8ixk</span>
      <span class="s">ARkWA2NvbTEXMBUGCgmSJomT8ixkARkWB2V4YW1wbGUxGTAXBgNVBAoMEEV4YW1w</span>
      <span class="s">bGUgQ29tIEluYy4xITAfBgNVBAsMGEV4YW1wbGUgQ29tIEluYy4gUm9vdCBDQTEh</span>
      <span class="s">...</span>
</code></pre></div></div> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.pemtrustedcas_filepath</code></td> <td style="text-align: left">Path to the PEM file containing the root CAs of your IdP. The files must be placed under the Open Distro for Elasticsearch <code class="highlighter-rouge">config</code> directory, and you must specify the path relative to that same directory.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.pemtrustedcas_content</code></td> <td style="text-align: left">The root CA content of your IdP server. Cannot be used when <code class="highlighter-rouge">pemtrustedcas_filepath</code> is set.</td> </tr> </tbody> </table></div> <h3 id="client-authentication">Client authentication</h3> <p>The security plugin can use TLS client authentication when fetching the IdP metadata. If enabled, the security plugin sends a TLS client certificate to the IdP for each metadata request. Use the following keys to configure client authentication.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.enable_ssl_client_auth</code></td> <td style="text-align: left">Whether to send a client certificate to the IdP server. Default is false.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.pemcert_filepath</code></td> <td style="text-align: left">Path to the PEM file containing the client certificate. The file must be placed under the Open Distro for Elasticsearch <code class="highlighter-rouge">config</code> directory, and the path must be specified relative to the <code class="highlighter-rouge">config</code> directory.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.pemcert_content</code></td> <td style="text-align: left">The content of the client certificate. Cannot be used when <code class="highlighter-rouge">pemcert_filepath</code> is set.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.pemkey_filepath</code></td> <td style="text-align: left">Path to the private key of the client certificate. The file must be placed under the Open Distro for Elasticsearch <code class="highlighter-rouge">config</code> directory, and the path must be specified relative to the <code class="highlighter-rouge">config</code> directory.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.pemkey_content</code></td> <td style="text-align: left">The content of the private key of your certificate. Cannot be used when <code class="highlighter-rouge">pemkey_filepath</code> is set.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.pemkey_password</code></td> <td style="text-align: left">The password of your private key, if any.</td> </tr> </tbody> </table></div> <h3 id="enabled-ciphers-and-protocols">Enabled ciphers and protocols</h3> <p>You can limit the allowed ciphers and TLS protocols for the IdP connection. For example, you can only enable strong ciphers and limit the TLS versions to the most recent ones.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.enabled_ssl_ciphers</code></td> <td style="text-align: left">Array of enabled TLS ciphers. Only the Java format is supported.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">idp.enabled_ssl_protocols</code></td> <td style="text-align: left">Array of enabled TLS protocols. Only the Java format is supported.</td> </tr> </tbody> </table></div> <h2 id="minimal-configuration-example">Minimal configuration example</h2> <p>The following example shows the minimal configuration:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">authc</span><span class="pi">:</span>
  <span class="na">saml_auth_domain</span><span class="pi">:</span>
    <span class="na">http_enabled</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">transport_enabled</span><span class="pi">:</span> <span class="no">false</span>
    <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">http_authenticator</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">saml</span>
      <span class="na">challenge</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">idp</span><span class="pi">:</span>
          <span class="na">metadata_file</span><span class="pi">:</span> <span class="s">metadata.xml</span>
          <span class="na">entity_id</span><span class="pi">:</span> <span class="s">http://idp.example.com/</span>
        <span class="na">sp</span><span class="pi">:</span>
          <span class="na">entity_id</span><span class="pi">:</span> <span class="s">https://kibana.example.com</span>
        <span class="na">kibana_url</span><span class="pi">:</span> <span class="s">https://kibana.example.com:5601/</span>
        <span class="na">roles_key</span><span class="pi">:</span> <span class="s">Role</span>
        <span class="na">exchange_key</span><span class="pi">:</span> <span class="s1">'</span><span class="s">peuvgOLrjzuhXf</span><span class="nv"> </span><span class="s">...'</span>
    <span class="na">authentication_backend</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div> <h2 id="kibana-configuration">Kibana configuration</h2> <p>Because most of the SAML-specific configuration is done in the security plugin, just activate SAML in your <code class="highlighter-rouge">kibana.yml</code> by adding the following:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>opendistro_security.auth.type: "saml"
</code></pre></div></div> <p>In addition, the Kibana endpoint for validating the SAML assertions must be whitelisted:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server.xsrf.whitelist: ["/_opendistro/_security/saml/acs"]
</code></pre></div></div> <p>If you use the logout POST binding, you also need to whitelist the logout endpoint:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">server.xsrf.whitelist</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">/_opendistro/_security/saml/acs"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">/_opendistro/_security/saml/logout"</span><span class="pi">]</span>
</code></pre></div></div> <h3 id="idp-initiated-sso">IdP-initiated SSO</h3> <p>To use IdP-initiated SSO, set the Assertion Consumer Service endpoint of your IdP to this:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/_opendistro/_security/saml/acs/idpinitiated
</code></pre></div></div> <p>Then add this endpoint to <code class="highlighter-rouge">server.xsrf.whitelist</code> in <code class="highlighter-rouge">kibana.yml</code>:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">server.xsrf.whitelist</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">/_opendistro/_security/saml/acs/idpinitiated"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">/_opendistro/_security/saml/acs"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">/_opendistro/_security/saml/logout"</span><span class="pi">]</span>
</code></pre></div></div> </div> </div> <div class="toc"> <ul class="toc-list"> <li class="toc-item"><a href="#docker-example">Docker example</a></li> <li class="toc-item"><a href="#activating-saml">Activating SAML</a></li> <li class="toc-item"><a href="#running-multiple-authentication-domains">Running multiple authentication domains</a></li> <li class="toc-item"><a href="#identity-provider-metadata">Identity provider metadata</a></li> <li class="toc-item"><a href="#idp-and-service-provider-entity-id">IdP and service provider entity ID</a></li> <li class="toc-item"><a href="#kibana-settings">Kibana settings</a></li> <li class="toc-item"><a href="#username-and-role-attributes">Username and Role attributes</a></li> <li class="toc-item"><a href="#request-signing">Request signing</a></li> <li class="toc-item"><a href="#logout">Logout</a></li> <li class="toc-item"><a href="#exchange-key-settings">Exchange key settings</a></li> <li class="toc-item"><a href="#tls-settings">TLS settings</a></li> <li class="toc-item"><a href="#minimal-configuration-example">Minimal configuration example</a></li> <li class="toc-item"><a href="#kibana-configuration">Kibana configuration</a></li> </ul> </div> <div class="search-overlay"></div> </div> <script> anchors.add(); </script> </body> </html>

<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>OpenID Connect - Open Distro for Elasticsearch Documentation</title> <link rel="shortcut icon" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135423944-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-135423944-1'); </script> <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>OpenID Connect | Open Distro for Elasticsearch Documentation</title> <meta name="generator" content="Jekyll v3.8.6" /> <meta property="og:title" content="OpenID Connect" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more." /> <meta property="og:description" content="Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more." /> <link rel="canonical" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/openid-connect/" /> <meta property="og:url" content="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/openid-connect/" /> <meta property="og:site_name" content="Open Distro for Elasticsearch Documentation" /> <script type="application/ld+json"> {"description":"Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more.","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/images/logo.svg"}},"url":"https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/openid-connect/","headline":"OpenID Connect","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script> <!-- SiteCatalyst code version: H.25.1. Copyright 1996-2012 Adobe, Inc. All Rights Reserved --> <script><!-- /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/ var s_code=s.t();if(s_code)document.write(s_code)//--></script> <script language="JavaScript" type="text/javascript"><!-- if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-') //--></script> <noscript> <img src="//amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazonalldev2/1/H.25.1--NS/0" height="1" width="1" border="0" alt="" /> </noscript> <!--/DO NOT REMOVE/--> <!-- End SiteCatalyst code version: H.25.1. --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/version-history/" class="nav-list-link">Version History</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/" class="nav-list-link">Install and Configure</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/docker/" class="nav-list-link">Docker</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/rpm/" class="nav-list-link">RPM</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/deb/" class="nav-list-link">Debian Package</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/helm/" class="nav-list-link">Helm</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/tar/" class="nav-list-link">Tarball</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/windows/" class="nav-list-link">Windows</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/docker-security/" class="nav-list-link">Docker Security Configuration</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/plugins/" class="nav-list-link">Standalone Elasticsearch Plugin Install</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/ami/" class="nav-list-link">Amazon Machine Image</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/other-components/" class="nav-list-link">Other Components</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/encryption-at-rest/" class="nav-list-link">Encryption at Rest</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/" class="nav-list-link">Upgrade</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-0-0/" class="nav-list-link">Upgrade to 1.x.x</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-11.0/" class="nav-list-link">Upgrade to 1.11.0</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-10-1/" class="nav-list-link">Upgrade to 1.10.1</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-8-0/" class="nav-list-link">Upgrade to 1.8.0</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/rolling/" class="nav-list-link">Rolling Upgrade</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/cluster-restart/" class="nav-list-link">Cluster Restart Upgrade</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/docker/" class="nav-list-link">Docker Upgrade</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/" class="nav-list-link">Elasticsearch</a><ul class="nav-list "><li class="nav-list-item active"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/configuration/" class="nav-list-link">Configuration</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/cluster/" class="nav-list-link">Cluster Formation</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-data/" class="nav-list-link">Index Data</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-alias/" class="nav-list-link">Index Aliases</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-templates/" class="nav-list-link">Index Templates</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/reindex-data/" class="nav-list-link">Reindex Data</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/catapis/" class="nav-list-link">CAT API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/term/" class="nav-list-link">Term-Level Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/full-text/" class="nav-list-link">Full-Text Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/search-template/" class="nav-list-link">Search Templates</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/bool/" class="nav-list-link">Boolean Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/ux/" class="nav-list-link">Search Experience</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/logs/" class="nav-list-link">Logs</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/snapshot-restore/" class="nav-list-link">Take and Restore Snapshots</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/units/" class="nav-list-link">Supported Units</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/common-parameters/" class="nav-list-link">Common REST Parameters</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/popular-api/" class="nav-list-link">Popular APIs</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/rest-api-reference/" class="nav-list-link">REST API Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/" class="nav-list-link">Kibana</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/plugins/" class="nav-list-link">Standalone Kibana Plugin Install</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/maptiles/" class="nav-list-link">WMS Map Server</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/" class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/" class="nav-list-link">Configuration</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/concepts/" class="nav-list-link">Authentication flow</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/configuration/" class="nav-list-link">Backend Configuration</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/yaml/" class="nav-list-link">YAML Files</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/tls/" class="nav-list-link">TLS Certificates</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/generate-certificates/" class="nav-list-link">Generate Certificates</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/security-admin/" class="nav-list-link">Apply Changes with securityadmin.sh</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/ldap/" class="nav-list-link">Active Directory and LDAP</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/saml/" class="nav-list-link">SAML</a> </li><li class="nav-list-item active"> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/openid-connect/" class="nav-list-link active">OpenID Connect</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/proxy/" class="nav-list-link">Proxy-based authentication</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/disable/" class="nav-list-link">Disable Security</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/" class="nav-list-link">Access Control</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/users-roles/" class="nav-list-link">Users and Roles</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/document-level-security/" class="nav-list-link">Document-Level Security</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/field-level-security/" class="nav-list-link">Field-Level Security</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/field-masking/" class="nav-list-link">Field Masking</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/impersonation/" class="nav-list-link">User Impersonation</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/multi-tenancy/" class="nav-list-link">Kibana Multi-Tenancy</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/cross-cluster-search/" class="nav-list-link">Cross-Cluster Search</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/permissions/" class="nav-list-link">Permissions</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/default-action-groups/" class="nav-list-link">Default Action Groups</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/api/" class="nav-list-link">API</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/" class="nav-list-link">Audit Logs</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/field-reference/" class="nav-list-link">Audit Log Field Reference</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/storage-types/" class="nav-list-link">Audit Log Storage Types</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/" class="nav-list-link">Alerting</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/monitors/" class="nav-list-link">Monitors</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/settings/" class="nav-list-link">Management</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/security-roles/" class="nav-list-link">Security Roles</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/cron/" class="nav-list-link">Cron</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/" class="nav-list-link">SQL</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/workbench/" class="nav-list-link">Workbench</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/cli/" class="nav-list-link">SQL CLI</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/basic/" class="nav-list-link">Basic Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/complex/" class="nav-list-link">Complex Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/partiql/" class="nav-list-link">JSON Support</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/sql-full-text/" class="nav-list-link">Full-Text Search</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/metadata/" class="nav-list-link">Metadata Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/functions/" class="nav-list-link">Functions</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/window/" class="nav-list-link">Window Functions</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/delete/" class="nav-list-link">Delete</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/endpoints/" class="nav-list-link">Endpoint</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/protocol/" class="nav-list-link">Protocol</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/monitoring/" class="nav-list-link">Monitoring</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/troubleshoot/" class="nav-list-link">Troubleshooting</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/limitation/" class="nav-list-link">Limitations</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/jdbc/" class="nav-list-link">JDBC Driver</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/odbc/" class="nav-list-link">ODBC Driver</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/" class="nav-list-link">PPL</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/endpoint/" class="nav-list-link">Endpoint</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/protocol/" class="nav-list-link">Protocol</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/commands/" class="nav-list-link">Commands</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/functions/" class="nav-list-link">Functions</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/" class="nav-list-link">Index State Management</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/policies/" class="nav-list-link">Policies</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/managedindices/" class="nav-list-link">Managed Indices</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/api/" class="nav-list-link">ISM API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/refresh-analyzer/" class="nav-list-link">Refresh Search Analyzer</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/knn/" class="nav-list-link">KNN</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/knn/settings/" class="nav-list-link">Settings and Statistics</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/" class="nav-list-link">Anomaly Detection</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/api/" class="nav-list-link">Anomaly Detection API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/cli/" class="nav-list-link">Anomaly Detection CLI</a></li></ul></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/notebooks/" class="nav-list-link">Notebooks</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/" class="nav-list-link">Performance Analyzer</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/dashboards/" class="nav-list-link">Create Dashboards</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/reference/" class="nav-list-link">Metrics Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/" class="nav-list-link">Root Cause Analysis</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/reference/" class="nav-list-link">RCA Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/" class="nav-list-link">Troubleshoot</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/tls/" class="nav-list-link">Troubleshoot TLS</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/saml/" class="nav-list-link">Troubleshoot SAML</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/openid-connect/" class="nav-list-link">Troubleshoot OpenID Connect</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/security-admin/" class="nav-list-link">Troubleshoot securityadmin.sh</a></li></ul></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/other/" class="nav-list-link">Other Resources</a></li></ul> </nav> <footer class="site-footer"> <p class="text-small text-grey-dk-100">See a problem? Submit <a href="https://github.com/opendistro/for-elasticsearch-docs/issues">issues</a> or <a href="https://github.com/opendistro/for-elasticsearch-docs/edit/master/docs/security/configuration/openid-connect.md">edit this page</a> on <a href="https://github.com/opendistro/for-elasticsearch-docs">GitHub</a>.</p> <p class="text-small text-grey-dk-100 mb-0">© 2020 Amazon Web Services, Inc. or its affiliates. All rights reserved.</p> </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search..." aria-label="Search Open Distro for Elasticsearch Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://opendistro.github.io/for-elasticsearch/" class="site-button" > Open Distro for Elasticsearch home </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/">Security</a></li> <li class="breadcrumb-nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/">Configuration</a></li> <li class="breadcrumb-nav-list-item"><span>OpenID Connect</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="openid-connect">OpenID Connect</h1> <p>The security plugin can integrate with identify providers that use the OpenID Connect standard. This feature enables the following:</p> <ul> <li> <p>Automatic configuration</p> <p>Point the security plugin to the metadata of your identity provider (IdP), and the security plugin uses that data for configuration.</p> </li> <li> <p>Automatic key fetching</p> <p>The security plugin automatically retrieves the public key for validating the JSON web tokens (JWTs) from the JSON web key set (JWKS) endpoint of your IdP. You don’t have to configure keys or shared secrets in <code class="highlighter-rouge">config.yml</code>.</p> </li> <li> <p>Key rollover</p> <p>You can change the keys used for signing the JWTs directly in your IdP. If the security plugin detects an unknown key, it tries to retrieve it from the IdP. This rollover is transparent to the user.</p> </li> <li> <p>Kibana single sign-on</p> </li> </ul> <h2 id="configure-openid-connect-integration">Configure OpenID Connect integration</h2> <p>To integrate with an OpenID IdP, set up an authentication domain and choose <code class="highlighter-rouge">openid</code> as the HTTP authentication type. JSON web tokens already contain all required information to verify the request, so set <code class="highlighter-rouge">challenge</code> to <code class="highlighter-rouge">false</code> and <code class="highlighter-rouge">authentication_backend</code> to <code class="highlighter-rouge">noop</code>.</p> <p>This is the minimal configuration:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">openid_auth_domain</span><span class="pi">:</span>
  <span class="na">http_enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">transport_enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">order</span><span class="pi">:</span> <span class="m">0</span>
  <span class="na">http_authenticator</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">openid</span>
    <span class="na">challenge</span><span class="pi">:</span> <span class="no">false</span>
    <span class="na">config</span><span class="pi">:</span>
      <span class="na">subject_key</span><span class="pi">:</span> <span class="s">preferred_username</span>
      <span class="na">roles_key</span><span class="pi">:</span> <span class="s">roles</span>
      <span class="na">openid_connect_url</span><span class="pi">:</span> <span class="s">https://keycloak.example.com:8080/auth/realms/master/.well-known/openid-configuration</span>
  <span class="na">authentication_backend</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div> <p>The following table shows the configuration parameters.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">openid_connect_url</code></td> <td style="text-align: left">The URL of your IdP where the security plugin can find the OpenID Connect metadata/configuration settings. This URL differs between IdPs. Required.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">jwt_header</code></td> <td style="text-align: left">The HTTP header that stores the token. Typically the <code class="highlighter-rouge">Authorization</code> header with the <code class="highlighter-rouge">Bearer</code> schema: <code class="highlighter-rouge">Authorization: Bearer &lt;token&gt;</code>. Optional. Default is <code class="highlighter-rouge">Authorization</code>.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">jwt_url_parameter</code></td> <td style="text-align: left">If the token is not transmitted in the HTTP header, but as an URL parameter, define the name of the parameter here. Optional.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">subject_key</code></td> <td style="text-align: left">The key in the JSON payload that stores the user’s name. If not defined, the <a href="https://tools.ietf.org/html/rfc7519#section-4.1.2">subject</a> registered claim is used. Most IdP providers use the <code class="highlighter-rouge">preferred_username</code> claim. Optional.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">roles_key</code></td> <td style="text-align: left">The key in the JSON payload that stores the user’s roles. The value of this key must be a comma-separated list of roles. Required only if you want to use roles in the JWT.</td> </tr> </tbody> </table></div> <h2 id="openid-connect-url">OpenID Connect URL</h2> <p>OpenID Connect specifies various endpoints for integration purposes. The most important endpoint is <code class="highlighter-rouge">well-known</code>, which lists endpoints and other configuration options for the security plugin.</p> <p>The URL differs between IdPs, but usually ends in <code class="highlighter-rouge">/.well-known/openid-configuration</code>.</p> <p>Keycloak example:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http(s)://&lt;server&gt;:&lt;port&gt;/auth/realms/&lt;realm&gt;/.well-known/openid-configuration
</code></pre></div></div> <p>The main information that the security plugin needs is <code class="highlighter-rouge">jwks_uri</code>. This URI specifies where the IdP’s public keys in JWKS format can be found. For example:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jwks_uri: "https://keycloak.example.com:8080/auth/realms/master/protocol/openid-connect/certs"
</code></pre></div></div> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{  
   keys:[  
      {  
         kid:"V-diposfUJIk5jDBFi_QRouiVinG5PowskcSWy5EuCo",
         kty:"RSA",
         alg:"RS256",
         use:"sig",
         n:"rI8aUrAcI_auAdF10KUopDOmEFa4qlUUaNoTER90XXWADtKne6VsYoD3ZnHGFXvPkRAQLM5d65ScBzWungcbLwZGWtWf5T2NzQj0wDyquMRwwIAsFDFtAZWkXRfXeXrFY0irYUS9rIJDafyMRvBbSz1FwWG7RTQkILkwiC4B8W1KdS5d9EZ8JPhrXvPMvW509g0GhLlkBSbPBeRSUlAS2Kk6nY5i3m6fi1H9CP3Y_X-TzOjOTsxQA_1pdP5uubXPUh5YfJihXcgewO9XXiqGDuQn6wZ3hrF6HTlhNWGcSyQPKh1gEcmXWQlRENZMvYET-BuJEE7eKyM5vRhjNoYR3w",
         e:"AQAB"
      }
   ]
}
</code></pre></div></div> <p>For more information about IdP endpoints, see the following:</p> <ul> <li><a href="https://developer.okta.com/docs/api/resources/oidc#well-knownopenid-configuration">Okta</a></li> <li><a href="https://www.keycloak.org/docs/latest/securing_apps/index.html#other-openid-connect-libraries">Keycloak</a></li> <li><a href="https://auth0.com/docs/protocols/oidc/openid-connect-discovery">Auth0</a></li> <li><a href="https://connect2id.com/products/server/docs/api/discovery">Connect2ID</a></li> <li><a href="https://help.salesforce.com/articleView?id=remoteaccess_using_openid_discovery_endpoint.htm&amp;type=5">Salesforce</a></li> <li><a href="https://www.ibm.com/support/knowledgecenter/en/SSEQTP_8.5.5/com.ibm.websphere.wlp.doc/ae/rwlp_oidc_endpoint_urls.html">IBM OpenID Connect</a></li> </ul> <h2 id="fetching-public-keys">Fetching public keys</h2> <p>When an IdP generates and signs a JSON web token, it must add the ID of the key to the JWT header. For example:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "alg": "RS256",
  "typ": "JWT",
  "kid": "V-diposfUJIk5jDBFi_QRouiVinG5PowskcSWy5EuCo"
}
</code></pre></div></div> <p>As per the <a href="http://openid.net/specs/openid-connect-messages-1_0-20.html">OpenID Connect specification</a>, the <code class="highlighter-rouge">kid</code> (key ID) is mandatory. Token verification does not work if an IdP fails to add the <code class="highlighter-rouge">kid</code> field to the JWT.</p> <p>If the security plugin receives a JWT with an unknown <code class="highlighter-rouge">kid</code>, it visits the IdP’s <code class="highlighter-rouge">jwks_uri</code> and retrieves all available, valid keys. These keys are used and cached until a refresh is triggered by retrieving another unknown key ID.</p> <h2 id="key-rollover-and-multiple-public-keys">Key rollover and multiple public keys</h2> <p>The security plugin can maintain multiple valid public keys at once. The OpenID specification does not allow for a validity period of public keys, so a key is valid until it has been removed from the list of valid keys in your IdP and the list of valid keys has been refreshed.</p> <p>If you want to roll over a key in your IdP, follow these best practices:</p> <ul> <li> <p>Create a new key pair in your IdP, and give the new key a higher priority than the currently used key.</p> <p>Your IdP uses this new key over the old key.</p> </li> <li> <p>Upon first appearance of the new <code class="highlighter-rouge">kid</code> in a JWT, the security plugin refreshes the key list.</p> <p>At this point, both the old key and the new key are valid. Tokens signed with the old key are also still valid.</p> </li> <li> <p>The old key can be removed from your IdP when the last JWT signed with this key has timed out.</p> </li> </ul> <p>If you have to immediately change your public key, you can also delete the old key first and then create a new one. In this case, all JWTs signed with the old key become invalid immediately.</p> <h2 id="tls-settings">TLS settings</h2> <p>To prevent man-in-the-middle attacks, you should secure the connection between the security plugin and your IdP with TLS.</p> <h3 id="enabling-tls">Enabling TLS</h3> <p>Use the following parameters to enable TLS for connecting to your IdP:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">enable_ssl</span><span class="pi">:</span> <span class="s">&lt;true|false&gt;</span>
  <span class="na">verify_hostnames</span><span class="pi">:</span> <span class="s">&lt;true|false&gt;</span>
</code></pre></div></div> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">enable_ssl</code></td> <td style="text-align: left">Whether to use TLS. Default is false.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">verify_hostnames</code></td> <td style="text-align: left">Whether to verify the hostnames of the IdP’s TLS certificate. Default is true.</td> </tr> </tbody> </table></div> <h3 id="certificate-validation">Certificate validation</h3> <p>To validate the TLS certificate of your IdP, configure either the path to the IdP’s root CA or the root certificate’s content:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">pemtrustedcas_filepath</span><span class="pi">:</span> <span class="s">/path/to/trusted_cas.pem</span>
</code></pre></div></div> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">pemtrustedcas_content</span><span class="pi">:</span> <span class="pi">|-</span>
    <span class="s">MIID/jCCAuagAwIBAgIBATANBgkqhkiG9w0BAQUFADCBjzETMBEGCgmSJomT8ixk</span>
    <span class="s">ARkWA2NvbTEXMBUGCgmSJomT8ixkARkWB2V4YW1wbGUxGTAXBgNVBAoMEEV4YW1w</span>
    <span class="s">bGUgQ29tIEluYy4xITAfBgNVBAsMGEV4YW1wbGUgQ29tIEluYy4gUm9vdCBDQTEh</span>
    <span class="s">...</span>
</code></pre></div></div> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">pemtrustedcas_filepath</code></td> <td style="text-align: left">Absolute path to the PEM file containing the root CAs of your IdP.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">pemtrustedcas_content</code></td> <td style="text-align: left">The root CA content of your IdP. Cannot be used if <code class="highlighter-rouge">pemtrustedcas_filepath</code> is set.</td> </tr> </tbody> </table></div> <h3 id="tls-client-authentication">TLS client authentication</h3> <p>To use TLS client authentication, configure the PEM certificate and private key the security plugin should send for TLS client authentication (or its content):</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">pemkey_filepath</span><span class="pi">:</span> <span class="s">/path/to/private.key.pem</span>
  <span class="na">pemkey_password</span><span class="pi">:</span> <span class="s">private_key_password</span>
  <span class="na">pemcert_filepath</span><span class="pi">:</span> <span class="s">/path/to/certificate.pem</span>
</code></pre></div></div> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">config</span><span class="pi">:</span>
  <span class="na">pemkey_content</span><span class="pi">:</span> <span class="pi">|-</span>
    <span class="s">MIID2jCCAsKgAwIBAgIBBTANBgkqhkiG9w0BAQUFADCBlTETMBEGCgmSJomT8ixk</span>
    <span class="s">ARkWA2NvbTEXMBUGCgmSJomT8ixkARkWB2V4YW1wbGUxGTAXBgNVBAoMEEV4YW1w</span>
    <span class="s">bGUgQ29tIEluYy4xJDAiBgNVBAsMG0V4YW1wbGUgQ29tIEluYy4gU2lnbmluZyBD</span>
    <span class="s">...</span>
  <span class="na">pemkey_password</span><span class="pi">:</span> <span class="s">private_key_password</span>
  <span class="na">pemcert_content</span><span class="pi">:</span> <span class="pi">|-</span>
    <span class="s">MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCHRZwzwGlP2FvL</span>
    <span class="s">oEzNeDu2XnOF+ram7rWPT6fxI+JJr3SDz1mSzixTeHq82P5A7RLdMULfQFMfQPfr</span>
    <span class="s">WXgB4qfisuDSt+CPocZRfUqqhGlMG2l8LgJMr58tn0AHvauvNTeiGlyXy0ShxHbD</span>
    <span class="s">...</span>
</code></pre></div></div> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">enable_ssl_client_auth</code></td> <td style="text-align: left">Whether to send the client certificate to the IdP server. Default is false.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">pemcert_filepath</code></td> <td style="text-align: left">Absolute path to the client certificate.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">pemcert_content</code></td> <td style="text-align: left">The content of the client certificate. Cannot be used when <code class="highlighter-rouge">pemcert_filepath</code> is set.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">pemkey_filepath</code></td> <td style="text-align: left">Absolute path to the file containing the private key of the client certificate.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">pemkey_content</code></td> <td style="text-align: left">The content of the private key of your client certificate. Cannot be used when <code class="highlighter-rouge">pemkey_filepath</code> is set.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">pemkey_password</code></td> <td style="text-align: left">The password of your private key, if any.</td> </tr> </tbody> </table></div> <h3 id="enabled-ciphers-and-protocols">Enabled ciphers and protocols</h3> <p>You can limit the allowed ciphers and TLS protocols by using the following keys.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">enabled_ssl_ciphers</code></td> <td style="text-align: left">Array. Enabled TLS cipher suites. Only Java format is supported.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">enabled_ssl_protocols</code></td> <td style="text-align: left">Array. Enabled TLS protocols. Only Java format is supported.</td> </tr> </tbody> </table></div> <h2 id="advanced-dos-protection">(Advanced) DoS protection</h2> <p>To help protect against denial-of-service (DoS) attacks, the security plugin only allows a maximum number of new key IDs in a certain span of time. If the number of new key IDs exceeds this threshold, the security plugin returns HTTP status code 503 (Service Unavailable) and refuses to query the IdP. By default, the security plugin does not allow for more than 10 unknown key IDs within 10 seconds. The following table shows how to modify these settings.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">refresh_rate_limit_count</code></td> <td style="text-align: left">The maximum number of unknown key IDs in the time frame. Default is 10.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">refresh_rate_limit_time_window_ms</code></td> <td style="text-align: left">The time frame to use when checking the maximum number of unknown key IDs, in milliseconds. Default is 10000 (10 seconds).</td> </tr> </tbody> </table></div> <h2 id="kibana-single-sign-on">Kibana single sign-on</h2> <p>Activate OpenID Connect by adding the following to <code class="highlighter-rouge">kibana.yml</code>:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>opendistro_security.auth.type: "openid"
</code></pre></div></div> <h3 id="configuration">Configuration</h3> <p>OpenID Connect providers usually publish their configuration in JSON format under the <em>metadata url</em>. Therefore, most settings can be pulled in automatically, so the Kibana configuration becomes minimal. The most important settings are the following:</p> <ul> <li><a href="#openid-connect-url">Connect URL</a></li> <li> <p>Client ID</p> <p>Every IdP can host multiple clients (sometimes called applications) with different settings and authentication protocols. When enabling OpenID Connect, you should create a new client for Kibana in your IdP. The client ID uniquely identifies Kibana.</p> </li> <li> <p>Client secret</p> <p>Beyond the ID, each client also has a client secret assigned. The client secret is usually generated when the client is created. Applications can obtain an identity token only when they provide a client secret. You can find this secret in the settings of the client on your IdP.</p> </li> </ul> <h3 id="configuration-parameters">Configuration parameters</h3> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Name</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">opendistro_security.openid.connect_url</code></td> <td style="text-align: left">The URL where the IdP publishes the OpenID metadata. Required.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">opendistro_security.openid.client_id</code></td> <td style="text-align: left">The ID of the OpenID Connect client configured in your IdP. Required.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">opendistro_security.openid.client_secret</code></td> <td style="text-align: left">The client secret of the OpenID Connect client configured in your IdP. Required.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">opendistro_security.openid.scope</code></td> <td style="text-align: left">The <a href="https://auth0.com/docs/scopes/current">scope of the identity token</a> issued by the IdP. Optional. Default is <code class="highlighter-rouge">openid profile email address phone</code>.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">opendistro_security.openid.header</code></td> <td style="text-align: left">HTTP header name of the JWT token. Optional. Default is <code class="highlighter-rouge">Authorization</code>.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">opendistro_security.openid.logout_url</code></td> <td style="text-align: left">The logout URL of your IdP. Optional. Only necessary if your IdP does not publish the logout URL in its metadata.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">opendistro_security.openid.base_redirect_url</code></td> <td style="text-align: left">The base of the redirect URL that will be sent to your IdP. Optional. Only necessary when Kibana is behind a reverse proxy, in which case it should be different than <code class="highlighter-rouge">server.host</code> and <code class="highlighter-rouge">server.port</code> in <code class="highlighter-rouge">kibana.yml</code>.</td> </tr> </tbody> </table></div> <h3 id="configuration-example">Configuration example</h3> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Enable OpenID authentication</span>
<span class="s">opendistro_security.auth.type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">openid"</span>

<span class="c1"># The IdP metadata endpoint</span>
<span class="s">opendistro_security.openid.connect_url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://keycloak.example.com:8080/auth/realms/master/.well-known/openid-configuration"</span>

<span class="c1"># The ID of the OpenID Connect client in your IdP</span>
<span class="s">opendistro_security.openid.client_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">kibana-sso"</span>

<span class="c1"># The client secret of the OpenID Connect client</span>
<span class="s">opendistro_security.openid.client_secret</span><span class="pi">:</span> <span class="s2">"</span><span class="s">a59c51f5-f052-4740-a3b0-e14ba355b520"</span>

<span class="c1"># Use HTTPS instead of HTTP</span>
<span class="s">elasticsearch.url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://&lt;hostname&gt;.com:&lt;http</span><span class="nv"> </span><span class="s">port&gt;"</span>

<span class="c1"># Configure the Kibana internal server user</span>
<span class="s">elasticsearch.username</span><span class="pi">:</span> <span class="s2">"</span><span class="s">kibanaserver"</span>
<span class="s">elasticsearch.password</span><span class="pi">:</span> <span class="s2">"</span><span class="s">kibanaserver"</span>

<span class="c1"># Disable SSL verification when using self-signed demo certificates</span>
<span class="s">elasticsearch.ssl.verificationMode</span><span class="pi">:</span> <span class="s">none</span>

<span class="c1"># Whitelist basic headers and multi-tenancy header</span>
<span class="s">elasticsearch.requestHeadersWhitelist</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">Authorization"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">security_tenant"</span><span class="pi">]</span>
</code></pre></div></div> <h3 id="elasticsearch-security-configuration">Elasticsearch security configuration</h3> <p>Because Kibana requires that the internal Kibana server user can authenticate through HTTP basic authentication, you must configure two authentication domains. For OpenID Connect, the HTTP basic domain has to be placed first in the chain. Make sure you set the challenge flag to <code class="highlighter-rouge">false</code>.</p> <p>Modify and apply the following example settings in <code class="highlighter-rouge">config.yml</code>:</p> <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">basic_internal_auth_domain</span><span class="pi">:</span>
  <span class="na">http_enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">transport_enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">order</span><span class="pi">:</span> <span class="m">0</span>
  <span class="na">http_authenticator</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">basic</span>
    <span class="na">challenge</span><span class="pi">:</span> <span class="no">false</span>
  <span class="na">authentication_backend</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">internal</span>
<span class="na">openid_auth_domain</span><span class="pi">:</span>
  <span class="na">http_enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">transport_enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">order</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">http_authenticator</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">openid</span>
    <span class="na">challenge</span><span class="pi">:</span> <span class="no">false</span>
    <span class="na">config</span><span class="pi">:</span>
      <span class="na">subject_key</span><span class="pi">:</span> <span class="s">preferred_username</span>
      <span class="na">roles_key</span><span class="pi">:</span> <span class="s">roles</span>
      <span class="na">openid_connect_url</span><span class="pi">:</span> <span class="s">https://keycloak.example.com:8080/auth/realms/master/.well-known/openid-configuration</span>
  <span class="na">authentication_backend</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">noop</span>
</code></pre></div></div> </div> </div> <div class="toc"> <ul class="toc-list"> <li class="toc-item"><a href="#configure-openid-connect-integration">Configure OpenID Connect integration</a></li> <li class="toc-item"><a href="#openid-connect-url">OpenID Connect URL</a></li> <li class="toc-item"><a href="#fetching-public-keys">Fetching public keys</a></li> <li class="toc-item"><a href="#key-rollover-and-multiple-public-keys">Key rollover and multiple public keys</a></li> <li class="toc-item"><a href="#tls-settings">TLS settings</a></li> <li class="toc-item"><a href="#advanced-dos-protection">(Advanced) DoS protection</a></li> <li class="toc-item"><a href="#kibana-single-sign-on">Kibana single sign-on</a></li> </ul> </div> <div class="search-overlay"></div> </div> <script> anchors.add(); </script> </body> </html>

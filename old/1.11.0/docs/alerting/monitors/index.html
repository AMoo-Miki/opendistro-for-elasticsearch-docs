<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Monitors - Open Distro for Elasticsearch Documentation</title> <link rel="shortcut icon" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135423944-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-135423944-1'); </script> <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Monitors | Open Distro for Elasticsearch Documentation</title> <meta name="generator" content="Jekyll v3.8.6" /> <meta property="og:title" content="Monitors" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more." /> <meta property="og:description" content="Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more." /> <link rel="canonical" href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/monitors/" /> <meta property="og:url" content="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/monitors/" /> <meta property="og:site_name" content="Open Distro for Elasticsearch Documentation" /> <script type="application/ld+json"> {"description":"Documentation for Open Distro for Elasticsearch, the community-driven, 100% open source distribution of Elasticsearch with advanced security, alerting, deep performance analysis, and more.","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/assets/images/logo.svg"}},"url":"https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/monitors/","headline":"Monitors","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script> <!-- SiteCatalyst code version: H.25.1. Copyright 1996-2012 Adobe, Inc. All Rights Reserved --> <script><!-- /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/ var s_code=s.t();if(s_code)document.write(s_code)//--></script> <script language="JavaScript" type="text/javascript"><!-- if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-') //--></script> <noscript> <img src="//amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazonalldev2/1/H.25.1--NS/0" height="1" width="1" border="0" alt="" /> </noscript> <!--/DO NOT REMOVE/--> <!-- End SiteCatalyst code version: H.25.1. --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/version-history/" class="nav-list-link">Version History</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/" class="nav-list-link">Install and Configure</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/docker/" class="nav-list-link">Docker</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/rpm/" class="nav-list-link">RPM</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/deb/" class="nav-list-link">Debian Package</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/helm/" class="nav-list-link">Helm</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/tar/" class="nav-list-link">Tarball</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/windows/" class="nav-list-link">Windows</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/docker-security/" class="nav-list-link">Docker Security Configuration</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/plugins/" class="nav-list-link">Standalone Elasticsearch Plugin Install</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/ami/" class="nav-list-link">Amazon Machine Image</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/other-components/" class="nav-list-link">Other Components</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/install/encryption-at-rest/" class="nav-list-link">Encryption at Rest</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/" class="nav-list-link">Upgrade</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-0-0/" class="nav-list-link">Upgrade to 1.x.x</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-11.0/" class="nav-list-link">Upgrade to 1.11.0</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-10-1/" class="nav-list-link">Upgrade to 1.10.1</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/1-8-0/" class="nav-list-link">Upgrade to 1.8.0</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/rolling/" class="nav-list-link">Rolling Upgrade</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/cluster-restart/" class="nav-list-link">Cluster Restart Upgrade</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/upgrade/docker/" class="nav-list-link">Docker Upgrade</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/" class="nav-list-link">Elasticsearch</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/configuration/" class="nav-list-link">Configuration</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/cluster/" class="nav-list-link">Cluster Formation</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-data/" class="nav-list-link">Index Data</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-alias/" class="nav-list-link">Index Aliases</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/index-templates/" class="nav-list-link">Index Templates</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/reindex-data/" class="nav-list-link">Reindex Data</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/catapis/" class="nav-list-link">CAT API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/term/" class="nav-list-link">Term-Level Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/full-text/" class="nav-list-link">Full-Text Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/search-template/" class="nav-list-link">Search Templates</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/bool/" class="nav-list-link">Boolean Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/ux/" class="nav-list-link">Search Experience</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/logs/" class="nav-list-link">Logs</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/snapshot-restore/" class="nav-list-link">Take and Restore Snapshots</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/units/" class="nav-list-link">Supported Units</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/common-parameters/" class="nav-list-link">Common REST Parameters</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/popular-api/" class="nav-list-link">Popular APIs</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/elasticsearch/rest-api-reference/" class="nav-list-link">REST API Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/" class="nav-list-link">Kibana</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/plugins/" class="nav-list-link">Standalone Kibana Plugin Install</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/kibana/maptiles/" class="nav-list-link">WMS Map Server</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/" class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/" class="nav-list-link">Configuration</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/concepts/" class="nav-list-link">Authentication flow</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/configuration/" class="nav-list-link">Backend Configuration</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/yaml/" class="nav-list-link">YAML Files</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/tls/" class="nav-list-link">TLS Certificates</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/generate-certificates/" class="nav-list-link">Generate Certificates</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/security-admin/" class="nav-list-link">Apply Changes with securityadmin.sh</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/ldap/" class="nav-list-link">Active Directory and LDAP</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/saml/" class="nav-list-link">SAML</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/openid-connect/" class="nav-list-link">OpenID Connect</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/proxy/" class="nav-list-link">Proxy-based authentication</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/configuration/disable/" class="nav-list-link">Disable Security</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/" class="nav-list-link">Access Control</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/users-roles/" class="nav-list-link">Users and Roles</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/document-level-security/" class="nav-list-link">Document-Level Security</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/field-level-security/" class="nav-list-link">Field-Level Security</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/field-masking/" class="nav-list-link">Field Masking</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/impersonation/" class="nav-list-link">User Impersonation</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/multi-tenancy/" class="nav-list-link">Kibana Multi-Tenancy</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/cross-cluster-search/" class="nav-list-link">Cross-Cluster Search</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/permissions/" class="nav-list-link">Permissions</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/default-action-groups/" class="nav-list-link">Default Action Groups</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/access-control/api/" class="nav-list-link">API</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/" class="nav-list-link">Audit Logs</a><ul class="nav-list"><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/field-reference/" class="nav-list-link">Audit Log Field Reference</a> </li><li class="nav-list-item "> <a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/security/audit-logs/storage-types/" class="nav-list-link">Audit Log Storage Types</a> </li></ul></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/" class="nav-list-link">Alerting</a><ul class="nav-list "><li class="nav-list-item active"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/monitors/" class="nav-list-link active">Monitors</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/settings/" class="nav-list-link">Management</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/security-roles/" class="nav-list-link">Security Roles</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/cron/" class="nav-list-link">Cron</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/" class="nav-list-link">SQL</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/workbench/" class="nav-list-link">Workbench</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/cli/" class="nav-list-link">SQL CLI</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/basic/" class="nav-list-link">Basic Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/complex/" class="nav-list-link">Complex Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/partiql/" class="nav-list-link">JSON Support</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/sql-full-text/" class="nav-list-link">Full-Text Search</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/metadata/" class="nav-list-link">Metadata Queries</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/functions/" class="nav-list-link">Functions</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/window/" class="nav-list-link">Window Functions</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/delete/" class="nav-list-link">Delete</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/endpoints/" class="nav-list-link">Endpoint</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/protocol/" class="nav-list-link">Protocol</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/monitoring/" class="nav-list-link">Monitoring</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/troubleshoot/" class="nav-list-link">Troubleshooting</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/limitation/" class="nav-list-link">Limitations</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/jdbc/" class="nav-list-link">JDBC Driver</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/sql/odbc/" class="nav-list-link">ODBC Driver</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/" class="nav-list-link">PPL</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/endpoint/" class="nav-list-link">Endpoint</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/protocol/" class="nav-list-link">Protocol</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/commands/" class="nav-list-link">Commands</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ppl/functions/" class="nav-list-link">Functions</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/" class="nav-list-link">Index State Management</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/policies/" class="nav-list-link">Policies</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/managedindices/" class="nav-list-link">Managed Indices</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/api/" class="nav-list-link">ISM API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ism/refresh-analyzer/" class="nav-list-link">Refresh Search Analyzer</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/knn/" class="nav-list-link">KNN</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/knn/settings/" class="nav-list-link">Settings and Statistics</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/" class="nav-list-link">Anomaly Detection</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/api/" class="nav-list-link">Anomaly Detection API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/ad/cli/" class="nav-list-link">Anomaly Detection CLI</a></li></ul></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/notebooks/" class="nav-list-link">Notebooks</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/" class="nav-list-link">Performance Analyzer</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/dashboards/" class="nav-list-link">Create Dashboards</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/pa/reference/" class="nav-list-link">Metrics Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/" class="nav-list-link">Root Cause Analysis</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/api/" class="nav-list-link">API</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/rca/reference/" class="nav-list-link">RCA Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/" class="nav-list-link">Troubleshoot</a><ul class="nav-list "><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/tls/" class="nav-list-link">Troubleshoot TLS</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/saml/" class="nav-list-link">Troubleshoot SAML</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/openid-connect/" class="nav-list-link">Troubleshoot OpenID Connect</a></li><li class="nav-list-item "><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/troubleshoot/security-admin/" class="nav-list-link">Troubleshoot securityadmin.sh</a></li></ul></li><li class="nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/other/" class="nav-list-link">Other Resources</a></li></ul> </nav> <footer class="site-footer"> <p class="text-small text-grey-dk-100">See a problem? Submit <a href="https://github.com/opendistro/for-elasticsearch-docs/issues">issues</a> or <a href="https://github.com/opendistro/for-elasticsearch-docs/edit/master/docs/alerting/monitors.md">edit this page</a> on <a href="https://github.com/opendistro/for-elasticsearch-docs">GitHub</a>.</p> <p class="text-small text-grey-dk-100 mb-0">© 2020 Amazon Web Services, Inc. or its affiliates. All rights reserved.</p> </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search..." aria-label="Search Open Distro for Elasticsearch Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://opendistro.github.io/for-elasticsearch/" class="site-button" > Open Distro for Elasticsearch home </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://opendistro.github.io/for-elasticsearch-docs/old/1.11.0/docs/alerting/">Alerting</a></li> <li class="breadcrumb-nav-list-item"><span>Monitors</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="monitors">Monitors</h1> <h4 id="table-of-contents">Table of contents</h4> <ul id="markdown-toc"> <li><a href="#key-terms" id="markdown-toc-key-terms">Key terms</a></li> <li><a href="#create-destinations" id="markdown-toc-create-destinations">Create destinations</a> <ul> <li><a href="#email-as-a-destination" id="markdown-toc-email-as-a-destination">Email as a destination</a></li> </ul> </li> <li><a href="#create-monitors" id="markdown-toc-create-monitors">Create monitors</a></li> <li><a href="#create-triggers" id="markdown-toc-create-triggers">Create triggers</a> <ul> <li><a href="#visual-graph" id="markdown-toc-visual-graph">Visual graph</a></li> <li><a href="#extraction-query" id="markdown-toc-extraction-query">Extraction query</a></li> <li><a href="#anomaly-detector" id="markdown-toc-anomaly-detector">Anomaly detector</a></li> </ul> </li> <li><a href="#add-actions" id="markdown-toc-add-actions">Add actions</a></li> <li><a href="#work-with-alerts" id="markdown-toc-work-with-alerts">Work with alerts</a></li> </ul> <hr /> <h2 id="key-terms">Key terms</h2> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Term</th> <th style="text-align: left">Definition</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">Monitor</td> <td style="text-align: left">A job that runs on a defined schedule and queries Elasticsearch. The results of these queries are then used as input for one or more <em>triggers</em>.</td> </tr> <tr> <td style="text-align: left">Trigger</td> <td style="text-align: left">Conditions that, if met, generate <em>alerts</em> and can perform some <em>action</em>.</td> </tr> <tr> <td style="text-align: left">Alert</td> <td style="text-align: left">A notification that a monitor’s trigger condition has been met.</td> </tr> <tr> <td style="text-align: left">Action</td> <td style="text-align: left">The information that you want the monitor to send out after being triggered. Actions have a <em>destination</em>, a message subject, and a message body.</td> </tr> <tr> <td style="text-align: left">Destination</td> <td style="text-align: left">A reusable location for an action, such as Amazon Chime, Slack, or a webhook URL.</td> </tr> </tbody> </table></div> <hr /> <h2 id="create-destinations">Create destinations</h2> <ol> <li>Choose <strong>Alerting</strong>, <strong>Destinations</strong>, <strong>Add destination</strong>.</li> <li>Specify a name for the destination so that you can identify it later.</li> <li>For <strong>Type</strong>, choose Slack, Amazon Chime, custom webhook, or <a href="#email-as-a-destination">email</a>.</li> </ol> <p>For Email type, refer to <a href="#email-as-a-destination">Email as a destination</a> section below. For all other types, specify the webhook URL. For more information about webhooks, see the documentation for <a href="https://api.slack.com/incoming-webhooks">Slack</a> and <a href="https://docs.aws.amazon.com/chime/latest/ug/webhooks.html">Chime</a>.</p> <p>For custom webhooks, you must specify more information: parameters and headers. For example, if your endpoint requires basic authentication, you might need to add a header with a key of <code class="highlighter-rouge">Authorization</code> and a value of <code class="highlighter-rouge">Basic &lt;Base64-encoded-credential-string&gt;</code>. You might also need to change <code class="highlighter-rouge">Content-Type</code> to whatever your webhook requires. Popular values are <code class="highlighter-rouge">application/json</code>, <code class="highlighter-rouge">application/xml</code>, and <code class="highlighter-rouge">text/plain</code>.</p> <p>This information is stored in plain text in the Elasticsearch cluster. We will improve this design in the future, but for now, the encoded credentials (which are neither encrypted nor hashed) might be visible to other Elasticsearch users.</p> <h3 id="email-as-a-destination">Email as a destination</h3> <p>To send or receive an alert notification as an email, first select <strong>Email</strong> as the destination <strong>Type</strong> for the alert. Next, you must add at least one sender and a recipient. We also recommend adding email groups if you want to notify more than a few people of an alert. You can configure senders and recipients using <strong>Manage senders</strong> and <strong>Manage email groups</strong>.</p> <h4 id="manage-senders">Manage senders</h4> <p>Manage senders allows you to configure and manage <strong>Sender</strong> email addresses. Senders are email accounts from where the alert notification is sent to different recipients or email groups.</p> <p>To configure a sender email, do the following:</p> <ol> <li>Once you choose <strong>Email</strong> as the destination <strong>Type</strong>, choose <strong>Manage senders</strong>, under <strong>Settings</strong>. You can also do this using the <strong>Actions</strong> button on the top right of the <strong>Destinations</strong> page.</li> <li>In the <strong>Manage email senders</strong> modal window, choose <strong>Add sender</strong>, <strong>New sender</strong>. Multiple senders can be added one at a time.</li> <li>Enter a unique <strong>Sender name</strong>.</li> <li>Enter the <strong>Email address</strong>, SMTP <strong>Host</strong> (e.g. <code class="highlighter-rouge">smtp.gmail.com</code> for a Gmail account), and the <strong>Port</strong> number.</li> <li>You can choose to use an <strong>Encryption method</strong> or leave it as <strong>None</strong>. However, most email providers require SSL or TLS and this requires you to add a username and password to the Elasticsearch keystore. Refer to <a href="#authenticate-sender-account">Authenticate sender account</a> to learn more.</li> <li>Choose <strong>Save</strong> to save the configuration and create the sender. You can create a sender even before you enter your credentials for SSL or TLS. However, you must <a href="#authenticate-sender-account">authenticate each sender account</a> with credentials before you use the destination to send your alert.</li> </ol> <p>Once the sender is created, the sender account is available to be selected when creating an email destination. You can reuse senders across many different destinations, but each destination only supports one sender.</p> <h4 id="manage-email-groups-or-recipients">Manage email groups or recipients</h4> <p>Use email groups to create and manage reusable lists of email addresses. For example, one alert might email the DevOps team, whereas another might email the DevOps team and the engineering team.</p> <p>You can enter individual email addresses, or an email group in the <strong>Recipients</strong> field. For email groups, you can pre-create a group using <strong>Manage email groups</strong>.</p> <p>To create and manage email groups, do the following:</p> <ol> <li>Once you select <strong>Email</strong> as the destination <strong>Type</strong>, choose <strong>Manage email groups</strong>, under <strong>Settings</strong>. Then choose <strong>Add email group</strong>, <strong>New email group</strong>. You can also do this using the <strong>Actions</strong> button on the top right of the <strong>Destinations</strong> page.</li> <li>Enter a unique <strong>Email group name</strong>.</li> <li>For recipient emails, enter any number of email addresses.</li> <li>Choose <strong>Save</strong>.</li> </ol> <p>You can view the list of all email destinations you created on the <strong>Destinations</strong> landing page. The <strong>Actions</strong> button on the top right of the <strong>Destinations</strong> page allows you to mange email senders and email groups from this page.</p> <h4 id="authenticate-sender-account">Authenticate sender account</h4> <p>You must authenticate each sender account with credentials before you send an alert notification from that account to recipients or email groups. You can enter these credentials in the Elasticsearch keystore using the CLI. Run the following commands (in your Elasticsearch directory) to enter your username and password. The <code class="highlighter-rouge">&lt;sender_name&gt;</code> is the name you entered for <strong>Sender</strong>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bin/elasticsearch-keystore add opendistro.alerting.destination.email.&lt;sender_name&gt;.username 
./bin/elasticsearch-keystore add opendistro.alerting.destination.email.&lt;sender_name&gt;.password
</code></pre></div></div> <p class="note"><strong>Note</strong>: The keystore settings are node-specific. You must run these commands on each node.</p> <p>To change or update your credentials (once you’ve added them in the keystore settings for every node), you can call the reload API to ensure that your new changes are automatically updated on every node. Run this command to call the reload API:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">POST</span><span class="w"> </span><span class="err">_nodes/reload_secure_settings</span><span class="w"> 
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"secure_settings_password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <hr /> <h2 id="create-monitors">Create monitors</h2> <ol> <li>Choose <strong>Alerting</strong>, <strong>Monitors</strong>, <strong>Create monitor</strong>.</li> <li>Specify a name and schedule for the monitor.</li> </ol> <p>The anomaly detection option is for pairing with the anomaly detection plugin. See <a href="../../ad/">Anomaly Detection</a>. For anomaly detector, choose an appropriate schedule for the monitor based on the detector interval. Otherwise, the alerting monitor may miss reading the results.</p> <p>For example, assume you set the monitor interval and the detector interval as 5 minutes, and you start the detector at 12:00. If an anomaly is detected at 12:05, it might be available at 12:06 because of the delay between writing the anomaly and it being available for queries. The monitor reads the anomaly results between 12:00 and 12:05, so it does not get the anomaly results available at 12:06.</p> <p>To avoid this issue, make sure the alerting monitor is at least twice the detector interval. When you create a monitor using Kibana, the anomaly detector plugin generates a default monitor schedule that’s twice the detector interval.</p> <p>Whenever you update a detector’s interval, make sure to update the associated monitor interval as well, as the anomaly detection plugin does not do this automatically.</p> <ol> <li>Choose one or more indices. You can also use <code class="highlighter-rouge">*</code> as a wildcard to specify an index pattern.</li> <li> <p>Define the monitor in one of three ways: visually, using a query, or using an anomaly detector.</p> <ul> <li> <p>Visual definition works well for monitors that you can define as “some value is above or below some threshold for some amount of time.”</p> </li> <li> <p>Query definition gives you flexibility in terms of what you query for (using <a href="../../elasticsearch/full-text">the Elasticsearch query DSL</a>) and how you evaluate the results of that query (Painless scripting).</p> <p>This example averages the <code class="highlighter-rouge">cpu_usage</code> field:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"match_all"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"aggs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"avg_cpu"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"avg"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cpu_usage"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div> </div> <p>You can even filter query results using <code class="highlighter-rouge">{{period_start}}</code> and <code class="highlighter-rouge">{{period_end}}</code>:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"query"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"bool"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nl">"range"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{period_end}}||-1h"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{period_end}}"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"include_lower"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"include_upper"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"epoch_millis"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"boost"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}],</span><span class="w">
      </span><span class="nl">"adjust_pure_negative"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"boost"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"aggregations"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div> </div> <p>“Start” and “end” refer to the interval at which the monitor runs. See <a href="#available-variables">Available variables</a>.</p> </li> </ul> </li> <li> <p>To define a monitor visually, choose <strong>Define using visual graph</strong>. Then choose an aggregation (for example, <code class="highlighter-rouge">count()</code> or <code class="highlighter-rouge">average()</code>), a set of documents, and a timeframe. Visual definition works well for most monitors.</p> <p>To use a query, choose <strong>Define using extraction query</strong>, add your query (using <a href="../../elasticsearch/full-text">the Elasticsearch query DSL</a>), and test it using the <strong>Run</strong> button.</p> <p>The monitor makes this query to Elasticsearch as often as the schedule dictates; check the <strong>Query Performance</strong> section and make sure you’re comfortable with the performance implications.</p> <p>To use an anomaly detector, choose <strong>Define using Anomaly detector</strong> and select your <strong>Detector</strong>.</p> </li> <li>Choose <strong>Create</strong>.</li> </ol> <hr /> <h2 id="create-triggers">Create triggers</h2> <p>The next step in creating a monitor is to create a trigger. These steps differ depending on whether you chose <strong>Define using visual graph</strong> or <strong>Define using extraction query</strong> or <strong>Define using Anomaly detector</strong> when you created the monitor.</p> <p>Either way, you begin by specifying a name and severity level for the trigger. Severity levels help you manage alerts. A trigger with a high severity level (e.g. 1) might page a specific individual, whereas a trigger with a low severity level might message a chat room.</p> <h3 id="visual-graph">Visual graph</h3> <p>For <strong>Trigger condition</strong>, specify a threshold for the aggregation and timeframe you chose earlier, such as “is below 1,000” or “is exactly 10.”</p> <p>The line moves up and down as you increase and decrease the threshold. Once this line is crossed, the trigger evaluates to true.</p> <h3 id="extraction-query">Extraction query</h3> <p>For <strong>Trigger condition</strong>, specify a Painless script that returns true or false. Painless is the default Elasticsearch scripting language and has a syntax similar to Groovy.</p> <p>Trigger condition scripts revolve around the <code class="highlighter-rouge">ctx.results[0]</code> variable, which corresponds to the extraction query response. For example, your script might reference <code class="highlighter-rouge">ctx.results[0].hits.total.value</code> or <code class="highlighter-rouge">ctx.results[0].hits.hits[i]._source.error_code</code>.</p> <p>A return value of true means the trigger condition has been met, and the trigger should execute its actions. Test your script using the <strong>Run</strong> button.</p> <p class="tip">The <strong>Info</strong> link next to <strong>Trigger condition</strong> contains a useful summary of the variables and results available to your query.</p> <h3 id="anomaly-detector">Anomaly detector</h3> <p>For <strong>Trigger type</strong>, choose <strong>Anomaly detector grade and confidence</strong>.</p> <p>Specify the <strong>Anomaly grade condition</strong> for the aggregation and timeframe you chose earlier, “IS ABOVE 0.7” or “IS EXACTLY 0.5.” The <em>anomaly grade</em> is a number between 0 and 1 that indicates the level of severity of how anomalous a data point is.</p> <p>Specify the <strong>Anomaly confidence condition</strong> for the aggregation and timeframe you chose earlier, “IS ABOVE 0.7” or “IS EXACTLY 0.5.” The <em>anomaly confidence</em> is an estimate of the probability that the reported anomaly grade matches the expected anomaly grade.</p> <p>The line moves up and down as you increase and decrease the threshold. Once this line is crossed, the trigger evaluates to true.</p> <h4 id="sample-scripts">Sample scripts</h4> <!-- These scripts are Painless, not Groovy, but calling them Groovy in Jekyll gets us syntax highlighting in the generated HTML. --> <div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Evaluates to true if the query returned any documents</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">results</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">hits</span><span class="o">.</span><span class="na">total</span><span class="o">.</span><span class="na">value</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div></div> <div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Returns true if the avg_cpu aggregation exceeds 90</span>
<span class="k">if</span> <span class="o">(</span><span class="n">ctx</span><span class="o">.</span><span class="na">results</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">aggregations</span><span class="o">.</span><span class="na">avg_cpu</span><span class="o">.</span><span class="na">value</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div> <div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Performs some crude custom scoring and returns true if that score exceeds a certain value</span>
<span class="kt">int</span> <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ctx</span><span class="o">.</span><span class="na">results</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">hits</span><span class="o">.</span><span class="na">hits</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="c1">// Weighs 500 errors 10 times as heavily as 503 errors</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">ctx</span><span class="o">.</span><span class="na">results</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">hits</span><span class="o">.</span><span class="na">hits</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">_source</span><span class="o">.</span><span class="na">http_status_code</span> <span class="o">==</span> <span class="s2">"500"</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">score</span> <span class="o">+=</span> <span class="mi">10</span><span class="o">;</span>
  <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">ctx</span><span class="o">.</span><span class="na">results</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">hits</span><span class="o">.</span><span class="na">hits</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">_source</span><span class="o">.</span><span class="na">http_status_code</span> <span class="o">==</span> <span class="s2">"503"</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
<span class="k">if</span> <span class="o">(</span><span class="n">score</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
  <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div> <h4 id="available-variables">Available variables</h4> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Variable</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="highlighter-rouge">ctx.results</code></td> <td style="text-align: left">An array with one element (i.e. <code class="highlighter-rouge">ctx.results[0]</code>). Contains the query results. This variable is empty if the trigger was unable to retrieve results. See <code class="highlighter-rouge">ctx.error</code>.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">ctx.monitor</code></td> <td style="text-align: left">Includes <code class="highlighter-rouge">ctx.monitor.name</code>, <code class="highlighter-rouge">ctx.monitor.type</code>, <code class="highlighter-rouge">ctx.monitor.enabled</code>, <code class="highlighter-rouge">ctx.monitor.enabled_time</code>, <code class="highlighter-rouge">ctx.monitor.schedule</code>, <code class="highlighter-rouge">ctx.monitor.inputs</code>, <code class="highlighter-rouge">triggers</code> and <code class="highlighter-rouge">ctx.monitor.last_update_time</code>.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">ctx.trigger</code></td> <td style="text-align: left">Includes <code class="highlighter-rouge">ctx.trigger.name</code>, <code class="highlighter-rouge">ctx.trigger.severity</code>, <code class="highlighter-rouge">ctx.trigger.condition</code>, and <code class="highlighter-rouge">ctx.trigger.actions</code>.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">ctx.periodStart</code></td> <td style="text-align: left">Unix timestamp for the beginning of the period during which the alert triggered. For example, if a monitor runs every ten minutes, a period might begin at 10:40 and end at 10:50.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">ctx.periodEnd</code></td> <td style="text-align: left">The end of the period during which the alert triggered.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">ctx.error</code></td> <td style="text-align: left">The error message if the trigger was unable to retrieve results or unable to evaluate the trigger, typically due to a compile error or null pointer exception. Null otherwise.</td> </tr> <tr> <td style="text-align: left"><code class="highlighter-rouge">ctx.alert</code></td> <td style="text-align: left">The current, active alert (if it exists). Includes <code class="highlighter-rouge">ctx.alert.id</code>, <code class="highlighter-rouge">ctx.alert.version</code>, and <code class="highlighter-rouge">ctx.alert.isAcknowledged</code>. Null if no alert is active.</td> </tr> </tbody> </table></div> <hr /> <h2 id="add-actions">Add actions</h2> <p>The final step in creating a monitor is to add one or more actions. Actions send notifications when trigger conditions are met and support <a href="https://slack.com/">Slack</a>, <a href="https://aws.amazon.com/chime/">Amazon Chime</a>, and webhooks.</p> <p class="tip">If you don’t want to receive notifications for alerts, you don’t have to add actions to your triggers. Instead, you can periodically check Kibana.</p> <ol> <li>Specify a name for the action.</li> <li>Choose a destination.</li> <li> <p>Add a subject and body for the message.</p> <p>You can add variables to your messages using <a href="https://mustache.github.io/mustache.5.html">Mustache templates</a>. You have access to <code class="highlighter-rouge">ctx.action.name</code>, the name of the current action, as well as all <a href="#available-variables">trigger variables</a>.</p> <p>If your destination is a custom webhook that expects a particular data format, you might need to include JSON (or even XML) directly in the message body:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Monitor {{ctx.monitor.name}} just entered alert status. Please investigate the issue. - Trigger: {{ctx.trigger.name}} - Severity: {{ctx.trigger.severity}} - Period start: {{ctx.periodStart}} - Period end: {{ctx.periodEnd}}"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div> </div> <p>In this case, the message content must conform to the <code class="highlighter-rouge">Content-Type</code> header in the <a href="#create-destinations">custom webhook</a>.</p> </li> <li>Choose <strong>Create</strong>.</li> </ol> <p>After an action sends a message, the content of that message has left the purview of the security plugin. Securing access to the message (e.g. access to the Slack channel) is your responsibility.</p> <h4 id="sample-message">Sample message</h4> <div class="language-mustache highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Monitor <span class="k">{{</span><span class="nv">ctx</span><span class="p">.</span><span class="nv">monitor</span><span class="p">.</span><span class="nv">name</span><span class="k">}}</span> just entered an alert state. Please investigate the issue.
- Trigger: <span class="k">{{</span><span class="nv">ctx</span><span class="p">.</span><span class="nv">trigger</span><span class="p">.</span><span class="nv">name</span><span class="k">}}</span>
- Severity: <span class="k">{{</span><span class="nv">ctx</span><span class="p">.</span><span class="nv">trigger</span><span class="p">.</span><span class="nv">severity</span><span class="k">}}</span>
- Period start: <span class="k">{{</span><span class="nv">ctx</span><span class="p">.</span><span class="nv">periodStart</span><span class="k">}}</span>
- Period end: <span class="k">{{</span><span class="nv">ctx</span><span class="p">.</span><span class="nv">periodEnd</span><span class="k">}}</span>
</code></pre></div></div> <p class="note">If you want to use the <code class="highlighter-rouge">ctx.results</code> variable in a message, use <code class="highlighter-rouge">{{ctx.results.0}}</code> rather than <code class="highlighter-rouge">{{ctx.results[0]}}</code>. This difference is due to how Mustache handles bracket notation.</p> <hr /> <h2 id="work-with-alerts">Work with alerts</h2> <p>Alerts persist until you resolve the root cause and have the following states:</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">State</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">Active</td> <td style="text-align: left">The alert is ongoing and unacknowledged. Alerts remain in this state until you acknowledge them, delete the trigger associated with the alert, or delete the monitor entirely.</td> </tr> <tr> <td style="text-align: left">Acknowledged</td> <td style="text-align: left">Someone has acknowledged the alert, but not fixed the root cause.</td> </tr> <tr> <td style="text-align: left">Completed</td> <td style="text-align: left">The alert is no longer ongoing. Alerts enter this state after the corresponding trigger evaluates to false.</td> </tr> <tr> <td style="text-align: left">Error</td> <td style="text-align: left">An error occurred while executing the trigger—usually the result of a a bad trigger or destination.</td> </tr> <tr> <td style="text-align: left">Deleted</td> <td style="text-align: left">Someone deleted the monitor or trigger associated with this alert while the alert was ongoing.</td> </tr> </tbody> </table></div> </div> </div> <div class="toc"> <ul class="toc-list"> <li class="toc-item"><a href="#key-terms">Key terms</a></li> <li class="toc-item"><a href="#create-destinations">Create destinations</a></li> <li class="toc-item"><a href="#create-monitors">Create monitors</a></li> <li class="toc-item"><a href="#create-triggers">Create triggers</a></li> <li class="toc-item"><a href="#add-actions">Add actions</a></li> <li class="toc-item"><a href="#work-with-alerts">Work with alerts</a></li> </ul> </div> <div class="search-overlay"></div> </div> <script> anchors.add(); </script> </body> </html>
